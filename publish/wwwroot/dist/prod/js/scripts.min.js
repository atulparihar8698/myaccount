"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var APIResponseErrorHandler={ParseJSON:function(e){return 204===e.status||205===e.status?null:e.json()},HandleError:function(e){throw e.response={status:0,statusText:"Cannot connect. Please make sure you are connected to internet and the API is up and running."},e},CheckStatus:function(t){return 200<=t.status&&t.status<300?t:t.json().then(function(e){return Promise.reject({status:t.status,ok:!1,statusText:t.statusText,body:e})})}},Observable=function(){function e(){_classCallCheck(this,e),this.observers=[]}return _createClass(e,[{key:"subscribe",value:function(e){this.observers.push(e)}},{key:"unsubscribe",value:function(t){this.observers=this.observers.filter(function(e){return e!==t})}},{key:"notify",value:function(t){this.observers.forEach(function(e){return e(t)})}}]),e}(),MessageCenter=function(r){var o,i;function s(e){r("#MessageCenterErrorMessage").html(e),r("#MessageCenterFailurePanel").show()}function l(e,t){e&&e.stack&&e.message&&s(t);e.body.Message;401===e.status?s(t):404===e.status?s(t):500===e.status&&s(t)}function t(e,t){var n=r("#".concat(e));if(n&&0<n.length){var a=n.validate().checkForm();if(Array.isArray(t)){for(var o=0;o<t.length;o++)t[o]="#".concat(t[o]);t=t.join()}else t="#".concat(t);a?r(t).removeClass("disabled"):r(t).addClass("disabled")}}return{Init:function(e){o=e,r("form[id='messageCenterForm']").validate({rules:{MessageCenterContent:{required:!0},MessageCenterRequestTypes:{required:!0}},messages:{MessageCenterContent:{required:"Please enter your message."},MessageCenterRequestTypes:{required:"Please select your request."}},highlight:function(e){r(e).addClass("is-invalid")},unhighlight:function(e){r(e).removeClass("is-invalid")},errorPlacement:function(e,t){r(t).next().append(e)},submitHandler:function(e,t){t.preventDefault(),r("#MessageCenterFailurePanel").hide();var n={Notes:escape(r("#MessageCenterContent").val()),TaskType:r("#MessageCenterRequestTypes option:selected").text()},a="".concat(o.submitMessageCenterRequest);fetch(a,{method:"POST",headers:{RequestVerificationToken:r('input:hidden[name="__RequestVerificationToken"]').val(),"Content-Type":"application/json",Access_Token:i,Is_Ajax_Request:!0},body:JSON.stringify(n)}).catch(APIResponseErrorHandler.HandleError).then(APIResponseErrorHandler.CheckStatus).then(APIResponseErrorHandler.ParseJSON).then(function(e){1===e.ResultCode?(r("#MessageCenterSuccessPanel").show(),r("#MesssageCenterTextAreaPanel").hide(),r("#MessageCenterSubmitPanel").hide()):s("An error occured in sending your message. ")}).catch(function(e){l(e,"An error occured in sending your message. ")}).finally(function(){})}}),r("#messageCenterForm").on("blur keyup change","input",function(e){t("MessageCenterPanel","MessageCenterSubmitBtn")}),r("#messageCenterForm").find("select").on("change",function(e){t("MessageCenterPanel","MessageCenterSubmitBtn")}),r("textarea").on("keyup",function(e){t("MessageCenterPanel","MessageCenterSubmitBtn")}),t("messageCenterForm","MessageCenterSubmitBtn")},LoadMessageCenter:function(e){r("#MessageCenterErrorMessage").html(""),r("#MessageCenterFailurePanel").hide(),r("#MessageCenterRequestTypes").hide(),r("#MessageCenterRequestTypesLoading").show(),r("textarea").val(""),i=e.SelectedAccount.split("*")[1];var t="".concat(o.getMessageCenterRequestTypes);fetch(t,{method:"GET",headers:{"Content-Type":"application/json",Access_Token:i,Is_Ajax_Request:!0}}).catch(APIResponseErrorHandler.HandleError).then(APIResponseErrorHandler.CheckStatus).then(APIResponseErrorHandler.ParseJSON).then(function(e){var t=r("#MessageCenterRequestTypes");r.each(e.RequestTypes,function(){t.append(r("<option />").val(this.RequestTypeId).text(this.RequestType))})}).catch(function(e){l(e,"An error occured. ")}).finally(function(){r("#MessageCenterRequestTypes").show(),r("#MessageCenterRequestTypesLoading").hide()})}}}(jQuery),ProfilePreferences=function(r){var i,s,o,t,n,a;function l(e){e.show()}function c(e,t){e&&e.stack&&e.message&&l(t);e.body.Message;401===e.status?l(t):404===e.status?l(t):500===e.status&&l(t)}return{Init:function(e){i=e,r("#btnUpdateEmailAddress").click(function(e){e.preventDefault();var t=r(this).find(">:first-child");"fa-pencil"===t[0].className.split(" ")[1]?t.removeClass("fa-pencil").addClass("fa-remove"):t.removeClass("fa-remove").addClass("fa-pencil"),r(".update-panel-email").toggle(250)}),r("#btnUpdatePhoneNumber").click(function(e){e.preventDefault();var t=r(this).find(">:first-child");"fa-pencil"===t[0].className.split(" ")[1]?t.removeClass("fa-pencil").addClass("fa-remove"):t.removeClass("fa-remove").addClass("fa-pencil"),r(".update-panel-phone-Number").toggle(250)}),r("#btnPassword").click(function(e){e.preventDefault();var t=r(this).find(">:first-child");"fa-pencil"===t[0].className.split(" ")[1]?t.removeClass("fa-pencil").addClass("fa-remove"):t.removeClass("fa-remove").addClass("fa-pencil"),r(".update-panel-password").toggle(250)}),r("#cancel-email-panel").click(function(e){r("form[name='changeEmailAddressForm'] :input").val(""),t.resetForm(),r("#UpdateEmailFailurePanel").hide(),r(".update-panel-email").toggle(250)}),r("#cancel-phone-panel").click(function(e){r("form[name='changePhoneNumberForm'] :input").val(""),n.resetForm(),r("#UpdatePhoneFailurePanel").hide(),r(".update-panel-phone-Number").toggle(250)}),r("#cancel-password-panel").click(function(e){r("form[name='changePasswordForm'] :input").val(""),a.resetForm(),r("#UpdatePasswordFailurePanel").hide(),r(".update-panel-password").toggle(250)}),jQuery.validator.addMethod("PhoneNumberCheck",function(e,t){return/^-?\d*$/.test(e)},"Please enter a valid phone number."),jQuery.validator.addMethod("PasswordCheck",function(e,t){return/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,20}$/.test(e)},"Please enter a valid password."),r("#chkInvoice").click(function(){r(this).prop("checked")?r("#chkPaperless")[0].checked&&(r(".go").html("<strong>Congrats!</strong><br>You are <br>Paperless"),r(".go").css("bottom","55px")):(r(".go").html("<strong>Go Paperless!</strong>"),r(".go").css("bottom","90px"))}),r("#chkPaperless").click(function(){r(this).prop("checked")?(r("#chkInvoice")[0].checked=!0,r(".go").html("<div><strong>Congrats!</strong><br>You are <br>Paperless</div>"),r(".go").css("bottom","55px")):(r(".go").html("<strong>Go Paperless!</strong>"),r(".go").css("bottom","90px"))}),function(){var o=r("#UpdateEmailFailurePanel");t=r("form[name='changeEmailAddressForm']").validate({rules:{email:{email:!0,required:!0},confirmEmail:{equalTo:'[name="email"]',email:!0}},messages:{email:"Please enter a valid email address",confirmEmail:{equalTo:"Emails should match"}},highlight:function(e){r(e).addClass("is-invalid")},unhighlight:function(e){r(e).removeClass("is-invalid")},errorPlacement:function(e,t){r(t).next().append(e)},submitHandler:function(e,t){t.preventDefault(),o.hide();var n=r("#email-address").val(),a="".concat(i.getUpdatedEmailMobile);fetch(a+"?Email="+n,{method:"GET",headers:{"Content-Type":"application/json",Access_Token:s,Is_Ajax_Request:!0}}).catch(APIResponseErrorHandler.HandleError).then(APIResponseErrorHandler.CheckStatus).then(APIResponseErrorHandler.ParseJSON).then(function(e){1===e.ResultCode?(r(".update-panel-email").hide(),r("#EmailDisplay").html(n)):l(o)}).catch(function(e){c(e,o)}).finally(function(){})}})}(),function(){var a=r("#UpdatePhoneFailurePanel");n=r("form[name='changePhoneNumberForm']").validate({rules:{phone:{PhoneNumberCheck:!0,required:!0},confirmPhone:{equalTo:'[name="phone"]'}},messages:{phone:{PhoneNumberCheck:"Please enter a valid phone number"},confirmPhone:{equalTo:"Phone number should match"}},highlight:function(e){r(e).addClass("is-invalid")},unhighlight:function(e){r(e).removeClass("is-invalid")},errorPlacement:function(e,t){r(t).next().append(e)},submitHandler:function(e,t){t.preventDefault(),a.hide();var n=r("#phone-number").val();fetch("".concat(i.getUpdatedEmailMobile,"?Mobile=").concat(n,"&Email=").concat(o.Email),{method:"GET",headers:{"Content-Type":"application/json",Access_Token:s,Is_Ajax_Request:!0}}).catch(APIResponseErrorHandler.HandleError).then(APIResponseErrorHandler.CheckStatus).then(APIResponseErrorHandler.ParseJSON).then(function(e){1===e.ResultCode?(r(".update-panel-phone-Number").hide(),r("#PhoneNumberDisplay").html(n)):l(a)}).catch(function(e){c(e,a)}).finally(function(){})}})}(),function(){var o=r("#UpdatePasswordFailurePanel");a=r("form[name='changePasswordForm']").validate({rules:{password:{PasswordCheck:!0,required:!0},confirmPassword:{equalTo:'[name="password"]'}},messages:{phone:{PasswordCheck:"Please enter a valid password"},confirmPhone:{equalTo:"Password should match"}},highlight:function(e){r(e).addClass("is-invalid")},unhighlight:function(e){r(e).removeClass("is-invalid")},errorPlacement:function(e,t){r(t).next().append(e)},submitHandler:function(e,t){t.preventDefault(),o.hide();var n={NewPassword:r("#password").val()},a="".concat(i.getResetPassword);fetch(a,{method:"POST",headers:{RequestVerificationToken:r('input:hidden[name="__RequestVerificationToken"]').val(),"Content-Type":"application/json",Access_Token:s,Is_Ajax_Request:!0},body:JSON.stringify(n)}).catch(APIResponseErrorHandler.HandleError).then(APIResponseErrorHandler.CheckStatus).then(APIResponseErrorHandler.ParseJSON).then(function(e){1===e.ResultCode?r(".update-panel-password").hide():l(o)}).catch(function(e){c(e,o)}).finally(function(){})}})}(),r(document).on("click",'[id ^= "btnEcommunicationorEbill"]',function(){var t=r("#UpdateECommFailurePanel");t.hide();var e={Ebill:r("#chkInvoice")[0].checked,ECommunication:r("#chkPaperless")[0].checked,CustNo:o.Customer_Number,Emailid:o.Email,MobileProvider:o.MobileProviderCode,Language:o.LanguageCode},n="".concat(i.getSubmitEnableEcommunicationOrEbill);fetch(n,{method:"POST",headers:{RequestVerificationToken:r('input:hidden[name="__RequestVerificationToken"]').val(),"Content-Type":"application/json",Access_Token:s,Is_Ajax_Request:!0},body:JSON.stringify(e)}).catch(APIResponseErrorHandler.HandleError).then(APIResponseErrorHandler.CheckStatus).then(APIResponseErrorHandler.ParseJSON).then(function(e){1===e.ResultCode?(r("#EcommOrEbillSuccessPanel").show(),r("#EcommOrEbillSuccessPanel").fadeOut(5e3)):l(t)}).catch(function(e){c(e,t)}).finally(function(){})}),r("#messageCenterForm").on("blur keyup change","input",function(e){ValidateMessageCenterForm("MessageCenterPanel","MessageCenterSubmitBtn")}),r("#messageCenterForm").find("select").on("change",function(e){ValidateMessageCenterForm("MessageCenterPanel","MessageCenterSubmitBtn")}),r("textarea").on("keyup",function(e){ValidateMessageCenterForm("MessageCenterPanel","MessageCenterSubmitBtn")})},LoadProfilePreferences:function(e){r("#loadingPanelPhone").show(),r("#loadingPanelEmail").show(),r("#loadingPanelPassword").show(),r("#emailPanel").hide(),r("#phonePanel").hide(),r("#passwordPanel").hide(),r("#UpdateEmailFailurePanel").hide(),r("#UpdatePhoneFailurePanel").hide(),r("#UpdatePasswordFailurePanel").hide(),r("#UpdateECommFailurePanel").hide(),s=e.SelectedAccount.split("*")[1],o=e.SelectedAccountDetails,r(function(){r('[data-toggle="tooltip"]').tooltip()}),r("#loadingPanelPhone").hide(),r("#loadingPanelEmail").hide(),r("#loadingPanelPassword").hide(),r("#emailPanel").show(),r("#phonePanel").show(),r("#passwordPanel").show(),r("#AccountNumberDisplay").html(e.SelectedAccount.split("*")[0].split("-")[0]),r("#EmailDisplay").html(o.Email),r("#PhoneNumberDisplay").html(o.Cell),document.getElementById("chkPaperless").checked=e.SelectedAccountDetails.Paperless,document.getElementById("chkInvoice").checked=e.SelectedAccountDetails.EBill,e.SelectedAccountDetails.Paperless&&e.SelectedAccountDetails.EBill&&(r(".go").html("<strong>Congrats!</strong><br>You are <br>Paperless"),r(".go").css("bottom","55px"))}}}(jQuery),AccountSelector=function(a){var o,r,i,s,l,c=new Observable;function n(){var t=store.get(s);if(r){var e=t.split("*")[1],n="".concat(o.getAccountDetailsUrl,"?accessToken=").concat(e);fetch(n,{method:"GET",headers:{"Content-Type":"application/json"}}).then(function(e){200===e.status?e.json().then(function(e){e&&c.notify({SelectedAccountDetails:e,SelectedAccount:t})}):400===e.status?e.json().then(function(e){}).catch(function(e){throw e}):e.status}).catch(function(e){}).finally(function(){})}else c.notify({SelectedAccount:t})}return{Init:function(e,t,n){o=e,r=1<arguments.length&&void 0!==t&&t,s="SelectedAccount_".concat(i=2<arguments.length?n:void 0),l="Accounts_".concat(i)},LoadAccounts:function(e){!function(e,t){if(0===a("#accountsSelector").length)return store.set(s,t),n();a("#accountsSelector").append(e.map(function(e){return"<option id='".concat(e.AccountId,"' value='").concat(e.CustomerNumber,"-").concat(e.AccountId,"*").concat(e.AccessToken,"'>").concat(e.DisplayValue,"</option>")})),a("#accountsSelector").on("change",function(){var t=a("#accountsSelector").val();store.get(l),(new Date).getTime();if(store.set(s,t),r){var e=t.split("*")[1],n="".concat(o.getAccountDetailsUrl,"?accessToken=").concat(e);fetch(n,{method:"GET",headers:{"Content-Type":"application/json"}}).then(function(e){200===e.status?e.json().then(function(e){e&&c.notify({SelectedAccountDetails:e,SelectedAccount:t})}):400===e.status?e.json().then(function(e){}).catch(function(e){throw e}):e.status}).catch(function(e){}).finally(function(){})}else c.notify({SelectedAccount:t})}),t&&a("#accountsSelector").val(t).change(),a("#accountsSelectorLoading").hide(),a("#accountsSelector").show(),1===e.length&&a("#accountsSelector").attr("disabled",!0)}(e.Accounts,e.SelectedAccount)},RegisterObserver:function(e){c.subscribe(e)},Reload:function(){n()}}}(jQuery),UnAuthorizedHandler=(jQuery,{Init:function(){},Handle401:function(){store.clearAll(),location.reload()}}),Dashboard=function(n){var a,o,r=new Observable;return{Init:function(e,t){a=e,o=t,MultiAccountModal.Init(r,a,o),n(document).on("click","#btnLogout",function(e){return e.preventDefault(),LogoutHandler.Logout(),!1})},RegisterObserver:function(e){r.subscribe(e)}}}(jQuery),MultiAccountModal=function(a){var o,r,i,s,l,c;function u(){console.log("I am Dashboard!!!"),r.subscribe(AccountSelector.LoadAccounts),function(){var e=store.get(c),t=store.get(l);e&&t?r.notify({Accounts:e,SelectedAccount:t}):(a("#multi-account-modal-placeholder").find(".modal").modal({backdrop:"static",keyboard:!1,show:!0}),fetch(i.getAccountsUrl,{method:"GET",headers:{"Content-Type":"application/json"}}).then(function(e){200===e.status?e.json().then(function(t){if(t&&t.Accounts){var n=function(e,t){o=t;(new Date).getTime();store.set(c,e),store.set(l,t)};if(1===t.Accounts.length)a("#multiAccountModal").modal("hide"),o="".concat(t.Accounts[0].CustomerNumber,"-").concat(t.Accounts[0].AccountId,"*").concat(t.Accounts[0].AccessToken),n(t.Accounts,o),r.notify({Accounts:t.Accounts,SelectedAccount:o});else{var e=a("#accountsTemplate").html();a("#accountsPanel").empty().html(Mustache.to_html(e,{RootTag:t.Accounts}));a("div[id^=accountItem]").click(function(){var e=a(this).attr("id").split("accountItem-")[1];n(t.Accounts,e),a("#multiAccountModal").modal("hide"),r.notify({Accounts:t.Accounts,SelectedAccount:e})})}}}):400===e.status?e.json().then(function(e){}).catch(function(e){throw e}):500===e.status&&(a("#sendSMSError").show(),a("#sendSMSError").find("b").html("Error in sending the SMS!! Please try again!!"))}).catch(function(e){}).finally(function(){a("#multiAccountPanelLoading").hide(),a("#multiAccountPanel").show()}))}()}return{Init:function(e,t,n){i=t,l="SelectedAccount_".concat(s=n),c="Accounts_".concat(s),r=e,u()},SelectedAccount:o}}(jQuery),DashboardLowerPanel=function(a){return{Init:function(e){e},LoadDashboardLowerPanel:function(e){a("#lowerPanelSecondItemLoadingPanel").show(),a("#autopaysingupPanel").hide(),a("#budgetbillingSignUpPanel").hide(),a("#energysavingtipsPanel").hide();var t=e.SelectedAccountDetails,n=t.Paperless;a("#lowerPanelSecondItemLoadingPanel").hide(),t.Auto_Pay?t.Auto_Pay&&!n?a("#budgetbillingSignUpPanel").show():a("#energysavingtipsPanel").show():a("#autopaysingupPanel").show()}}}(jQuery),LogoutHandler=function(){var n,a;return{Init:function(e){n=e},SetSelectedAccount:function(e){a=e},Logout:function(){store.clearAll();var e=a.SelectedAccount.split("*")[1],t="".concat(n.logout);fetch(t,{method:"POST",headers:{"Content-Type":"application/json",Access_Token:e,Is_Ajax_Request:!0}}).then(function(e){200===e.status?e.json().then(function(e){window.location.href=e.redirectToUrl}):400===e.status?e.json().then(function(e){}).catch(function(e){throw e}):401===e.status?UnAuthorizedHandler.Handle401():e.status}).catch(function(e){}).finally(function(){})}}}(jQuery),EnergyInsightsUsageHistory=function(s){var o,r,i,l,c,u=new Array,d=new Array,h=new Array;function m(){for(var e=s("#MonthlyChart").data("kendoChart"),t=0;t<e.dataSource.view().length;t++)u[t]=e.dataSource.view()[t].StartDate+"-"+e.dataSource.view()[t].EndDate}function f(e){P(l=e.dataItem.StartDate+"-"+e.dataItem.EndDate)}function P(e){var t=u.indexOf(e);0===t&&t===d.length-1||(s("#btnDailyNext").removeAttr("disabled"),s("#btnDailyPrev").removeAttr("disabled")),t===d.length-1&&s("#btnDailyNext").attr("disabled","disabled"),0===t&&s("#btnDailyPrev").attr("disabled","disabled");var n=e.split("-")[0],a=e.split("-")[1],o="".concat(i,"?StartDate=").concat(n,"&EndDate=").concat(a,"&ResolutionCode=P");s("#UsageHistoryDailyLoadingPanel").show(),fetch(o,{method:"GET",headers:{"Content-Type":"application/json",Access_Token:r,Is_Ajax_Request:!0}}).then(function(e){200===e.status?e.json().then(function(e){e&&(s("#UsageHistoryDailyLoadingPanel").hide(),s("#UsageChartMonthlyDiv").hide(),s("#UsageChartDailyDiv").show(),s("#DailyChart").data("kendoChart").dataSource.data(e),s("#UsageHistoryHeader").html("Daily Usage History"),s("#ZoomOutDiv").show(),s("#btnDailyUsageGroup").show(),s("#btnCurrent").html(n+" - "+a))}):400===e.status?e.json().then(function(e){}).catch(function(e){throw e}):401===e.status?UnAuthorizedHandler.Handle401():e.status}).catch(function(e){}).finally(function(){})}function p(e,t){var n=d.indexOf(e);0===n&&n===d.length-1||(s("#btnHourlyNext").removeAttr("disabled"),s("#btnHourlyPrev").removeAttr("disabled")),n===d.length-1&&s("#btnHourlyNext").attr("disabled","disabled"),0===n&&s("#btnHourlyPrev").attr("disabled","disabled");var a=t.split("-")[0],o="".concat(i,"?StartDate=").concat(a,"&ResolutionCode=D");s("#UsageHistoryDailyLoadingPanel").show(),fetch(o,{method:"GET",headers:{"Content-Type":"application/json",Access_Token:r,Is_Ajax_Request:!0}}).then(function(e){200===e.status?e.json().then(function(e){e&&(s("#UsageHistoryDailyLoadingPanel").hide(),s("#UsageChartMonthlyDiv").hide(),s("#UsageChartDailyDiv").hide(),s("#UsageChartHourlyDiv").show(),s("#HourlyChart").data("kendoChart").dataSource.data(e),s("#UsageHistoryHeader").html("Hourly Usage History"),s("#ZoomOutDiv").show(),s("#btnHourlyUsageGroup").show(),s("#btnDailyUsageGroup").hide(),s("#btnHourlyCurrent").html(t.split("-")[1]))}):400===e.status?e.json().then(function(e){}).catch(function(e){throw e}):401===e.status?UnAuthorizedHandler.Handle401():e.status}).catch(function(e){}).finally(function(){})}function g(e){"read"===e.type&&e.response&&(s("#UsageHistoryLoadingPanel").hide(),s("#UsageHistoryChartPanel").show())}function y(e){!function(a){if(!(a=a.map(function(e){return{KWH:e.KWH,AverageTemperature:e.AverageTemperature,StartDate:e.StartDate,EndDate:e.EndDate}}))||0===a.length)return;s("#UsageHistoryTable").show();var o=[{title:"Date",name:"StartDate",sort:"desc",type:"date"},{title:"kWh",name:"KWH",sort:"",type:"number"},{title:"Temperature",name:"AverageTemperature",sort:"",type:"number"}],r={paging:!0,sorting:{columnHeaders:o}};function i(e){e.sorting&&Object.assign(r.sorting,e.sorting);var t=function(e,t){if(!t.sorting)return e;var n=(r.sorting.columnHeaders||[]).find(function(e){if(e.hasOwnProperty("sort")&&""!==e.sort)return!0});return e.sort(function(e,t){if("date"===n.type){if(new Date(null!=e[n.name]?e[n.name]:new Date)>new Date(null!=t[n.name]?t[n.name]:new Date))return"desc"===n.sort?-1:1;if(new Date(null!=e[n.name]?e[n.name]:new Date)<new Date(null!=t[n.name]?t[n.name]:new Date))return"asc"===n.sort?-1:1}else if("number"===n.type){if(parseInt(e[n.name])>parseInt(t[n.name]))return"desc"===n.sort?-1:1;if(parseInt(e[n.name])<parseInt(t[n.name]))return"asc"===n.sort?-1:1}return 0})}(a,r);!function(){var e=s("#usageHistoryHeaderTemplate").html();s("#usageHistoryHeader").empty().html(Mustache.to_html(e,{RootTag:o}))}();var n=s("#usageHistoryTemplate").html();s("#usageHistorytblBody").empty().html(Mustache.to_html(n,{RootTag:t}))}s(document).on("click",'[id ^= "UsageHistoryColumn-"]',function(){var t=s(this).attr("id").split("UsageHistoryColumn-")[1];!function(n){var e=Object.assign({},r.sorting).columnHeaders.map(function(e){if(n.name!==e.name)return Object.assign(e,{sort:""});var t="asc"===e.sort?"desc":"asc";return Object.assign(e,{sort:t})});i(Object.assign({},r,{sorting:{columns:e}}))}(o.find(function(e){return e.name===t}))}),i(r)}(e.items);var t=this.data();t&&0!==t.length||(s("#NoUsageHistoryPanel").show(),s("#UsageHistoryChartPanel").hide())}function v(e){var t=e.xhr.status;400===t?response.json().then(function(e){console.log("Bad Request.. Try Again")}).catch(function(e){throw e}):401===t&&UnAuthorizedHandler.Handle401()}function b(e){for(var t=s("#DailyChart").data("kendoChart"),n=0;n<t.dataSource.view().length;n++)d[n]=t.dataSource.view()[n].UsageDate+"-"+t.dataSource.view()[n].EndDate,h[n]=t.dataSource.view()[n].DailychartDay}function C(e){var t=new Date(e.category),n=t.getMonth()+1+"/"+t.getDate()+"/"+t.getFullYear();p(c=e.dataItem.UsageDate+"-"+e.dataItem.EndDate,n+"-"+e.dataItem.DailychartDay)}return{Init:function(e){o=e;var t=s("#DailyChart").data("kendoChart");t.bind("dataBound",b),t.bind("seriesClick",C);var n=s("#MonthlyChart").data("kendoChart");n.bind("dataBound",m),n.bind("seriesClick",f);var a=n.dataSource;a.bind("error",v),a.bind("change",y),a.bind("requestEnd",g),s("#btnZoom").click(function(){s("#UsageHistoryDailyLoadingPanel").hide(),s("#UsageChartMonthlyDiv").show(),s("#UsageChartDailyDiv").hide(),s("#UsageChartHourlyDiv").hide(),s("#UsageHistoryHeader").html("Invoiced Monthly Usage History"),s("#ZoomOutDiv").hide(),s("#btnDailyUsageGroup").hide(),s("#btnHourlyUsageGroup").hide(),s("#btnCurrent").html(""),s("#btnDailyPrev").removeAttr("disabled"),s("#btnDailyNext").removeAttr("disabled"),s("#btnHourlyPrev").removeAttr("disabled"),s("#btnHourlyNext").removeAttr("disabled")}),s("#btnDailyPrev").click(function(){var e=u.find(function(e){return e===l});if(e){var t=u.indexOf(e);P(l=u[t-1])}}),s("#btnDailyNext").click(function(){var e=u.find(function(e){return e===l});if(e){var t=u.indexOf(e);P(l=u[t+1])}}),s("#btnHourlyPrev").click(function(){var e=d.find(function(e){return e===c});if(e){var t=d.indexOf(e);p(c=d[t-1],c.split("-")[0]+"-"+h[t-1])}}),s("#btnHourlyNext").click(function(){var e=d.find(function(e){return e===c});if(e){var t=d.indexOf(e);p(c=d[t+1],c.split("-")[0]+"-"+h[t+1])}})},LoadEnergyInsightsUsageHistory:function(e){s("#UsageHistoryLoadingPanel").show(),s("#UsageHistoryChartPanel").hide(),s("#NoUsageHistoryPanel").hide(),r=e.SelectedAccount.split("*")[1],i="".concat(o.getUsageHistory);var t=s("#MonthlyChart").data("kendoChart").dataSource;t.transport.options.read.beforeSend=function(e){e.setRequestHeader("Access_Token",r),e.setRequestHeader("Is_Ajax_Request",!0)},t.read()}}}(jQuery);function processApiData(e){var t={};for(var n in e)e[n]&&(t[e[n].EndDate]||(t[e[n].EndDate]={avgTemperature:0,usage:0,date:moment(new Date(e[n].EndDate).toISOString(),moment.ISO_8601).toDate()}),t[e[n].EndDate].usage+=parseInt(e[n].KWH),t[e[n].EndDate].avgTemperature+=parseInt(e[n].AverageTemperature));return _.sortBy(_.values(t))}var HomeCarousel=function(o){return{Init:function(e){e},LoadCarousel:function(e){var t=e.SelectedAccountDetails,n=t.Paperless;if(t.ReNew?(o("#home-carousel-component .carousel-indicators li").eq(0).attr("data-slide-to",0),o("#home-carousel-component .carousel-item").eq(0).addClass("active"),o("#home-carousel-component .carousel-item").eq(1).removeClass("active"),o("#home-carousel-component .carousel-indicators li").eq(0).addClass("active"),o("#home-carousel-component .carousel-indicators li").eq(1).removeClass("active")):(o("#home-carousel-component .carousel-item").eq(0).remove(),o("#home-carousel-component .carousel-indicators li").eq(0).remove(),o("#home-carousel-component .carousel-indicators li").eq(0).attr("data-slide-to",0),o("#home-carousel-component .carousel-item").eq(0).addClass("active")),n){var a=o("#home-carousel-component .carousel-item").length-1;o("#home-carousel-component .carousel-item").eq(a).remove(),o("#home-carousel-component .carousel-indicators li").eq(a).remove()}}}}(jQuery),Login=function(n){var a;function o(){n("#RegisterModal-placeholder").find(".modal").modal({backdrop:"static",keyboard:!1,show:!0}),Registration.Init(a)}return{Init:function(e,t){a=t,store.clearAll(),e,n("#registerButton").click(function(){o()}),new URLSearchParams(window.location.search).get("Page")&&o()}}}(jQuery),MakePayment=function(i){var s,o,r,l,t,n,c,u,d,h;return{Init:function(e,t,n){function a(e){if(e&&e.data){if(d=i("#MakePaymentIFrame")[0],"ViewMyBill"===e.data.Redirect&&(window.location.href="/Payments/ViewMyBill"),e.data.ReLoadCallback){var t="".concat(s.getAccountDetailsUrl,"?accessToken=").concat(l);fetch(t,{method:"GET",headers:{"Content-Type":"application/json"}}).then(function(e){200===e.status?e.json().then(function(e){e&&((u={SessionId:c,CustomerNumber:e.Customer_Number,CustomerAccountId:e.CustomerAccountId,AccountStatus:e.AccountStatus,ConnectStatus:e.ConnectStatus,PastDue:e.PastDue,CurrentBalance:e.CurrentBalance,IsAutoPay:e.Auto_Pay,LastInvoiceDueDate:e.LastInvoiceDueDate,IsInsertPCILog:"1",PastDueDisplayValue:e.PastDueDisplayValue,CurrentBalaceDisplayValue:e.CurrentBalaceDisplayValue,FirstName:i("FirstNameHidden").val(),LastName:i("LastNameHidden").val(),Email:e.Email,ContactNumber:e.Cell,MakePaymentResponseCallback:!0}).ContactNumber||e.Phone,d.contentWindow.postMessage(u,"*"))}):400===e.status?e.json().then(function(e){}).catch(function(e){throw e}):e.status}).catch(function(e){}).finally(function(){})}if(e.data.height&&d.contentWindow===e.source&&(d.height=e.data.height+"px",d.style.height=e.data.height+"px"),e.data.Loaded)var n=setInterval(function(e){u&&(clearInterval(n),d.contentWindow.postMessage(u,"*"))},200);if(e.data.INSERTPCI){var a={ChildId:e.data.ChildUniqueId,PCISessionId:e.data.PCISessionId,SelectedAccountNumber:h,InsertPCITransactionUrl:"".concat(s.insertPCITransaction),AccessToken:l,Url:"".concat(s.validatePCITransactionLog)};PaymentsHelper.ValidatePCITransaction(a,function(){i("#MakePaymentErrorPanel").hide(),i("#MakePaymentLoadingPanel").hide(),i("#MakePaymentPanel").show()},function(){i("#MakePaymentLoadingPanel").hide(),i("#MakePaymentPanel").hide(),i("#MakePaymentErrorPanel").show()})}if(e.data.NotifyPaymentTransaction){var o=e.data,r={Url:"".concat(s.insertTransaction),AccessToken:l,Amount:o.Amount,MethodName:o.MethodName,objPmtResp:{PurchaseAmount:o.PurchaseAmount,TaxAmount:o.TaxAmount,Rate:o.Rate,KWHPurchased:o.KWHPurchased,AuthCode:o.AuthCode,orionResult:o.orionResult,profileStatusCode:o.profileStatusCode,profileStatusMessage:o.profileStatusMessage}};PaymentsHelper.InsertTransaction(r,function(){},function(){})}}}s=e,o=t,r=n,document.querySelector("#MakePaymentIFrame").onload=function(){},i("#MakePaymentIFrame").on("load",function(){}),window.addEventListener?window.addEventListener("message",a,!1):window.attachEvent("onmessage",a)},LoadMakePayment:function(e){i("#MakePaymentLoadingPanel").show(),i("#MakePaymentPanel").hide(),i("#MakePaymentErrorPanel").hide(),l=e.SelectedAccount.split("*")[1],n=e.SelectedAccountDetails,h=e.SelectedAccount.split("*")[0].split("-")[0],t="".concat(s.getPaymentToken),fetch(t,{method:"GET",headers:{"Content-Type":"application/json"}}).then(function(e){200===e.status?e.json().then(function(e){if(e){var t=c=e.SessionId;(u={SessionId:t,CustomerNumber:n.Customer_Number,CustomerAccountId:n.CustomerAccountId,AccountStatus:n.AccountStatus,ConnectStatus:n.ConnectStatus,PastDue:n.PastDue,CurrentBalance:n.CurrentBalance,IsAutoPay:n.Auto_Pay,LastInvoiceDueDate:n.LastInvoiceDueDate,IsInsertPCILog:"1",PastDueDisplayValue:n.PastDueDisplayValue,CurrentBalaceDisplayValue:n.CurrentBalaceDisplayValue,FirstName:i("#FirstNameHidden").val(),LastName:i("#LastNameHidden").val(),Email:n.Email,ContactNumber:n.Cell}).ContactNumber||n.Phone,document.getElementById("MakePaymentIFrame").src="".concat(r,"MakePayment?Brand=").concat(o)}}):400===e.status?e.json().then(function(e){}).catch(function(e){throw e}):e.status}).catch(function(e){}).finally(function(){})}}}(jQuery),MyBill=function(a){return{Init:function(e){e},LoadMyBill:function(e){a("#myBillLoadingPanel").show(),a("#suspendedAccountPanel").hide(),a("#activeServiceAccountPanel").hide(),a("#PastDueExistsPanel").hide(),a("#LatestPaymentPanel").hide(),a("#PastDuePayNowPanel").hide(),a("#PaymentPendingPanel").hide(),a("#AutoPayPanel").hide(),a("#PaymentScheduledPanel").hide(),a("#MakePaymentPanel").hide(),a("#PaymentScheduledLabel").text(),a("#AutoPayLabel").text(),a("#PaymentPendingPanelLabel").text();var t=e.SelectedAccountDetails;a("#myBillLoadingPanel").hide(),a("#myBillPanel").show(),"suspended"===t.AccountStatus.toLowerCase()&&a("#suspendedAccountPanel").show(),a("#activeServiceAccountPanel").show();var n=parseFloat(t.TotalDue);if((t.IsPastDue||t.TotalDue&&0<n)&&t.HasAtleastOnePayment&&(a("#PastDueExistsPanel").show(),a("#DueDate").text(t.LatestInvoiceDueDate)),!t.IsPastDue&&t.HasAtleastOnePayment&&n<=0&&(a("#LatestPaymentPanel").show(),a("#LatestBillAmount").text(t.LastPaymentAmountDisplayValue),a("#LatestBillPaymentDate").text(t.LastPaymentDateDisplayValue)),t.IsPastDue?(a("#myBillHeading").addClass("exceededDueDate"),a("#paymentBtn").addClass("exceededDueDate")):(a("#myBillHeading").addClass("paymentMade"),a("#paymentBtn").addClass("paymentMade")),a("#TotalDueLabel").text(t.TotalDueDisplayValue),a("#CurrentDueLabel").text(t.CurrentBalaceDisplayValue),a("#PastDueLabel").text(t.PastDueDisplayValue),t.MyBillDisplayView)switch(t.MyBillDisplayView){case"PastDuePayNow":a("#PastDuePayNowPanel").show();break;case"PaymentPending":a("#PaymentPendingPanel").show(),t.Auto_Pay||(a("#PaymentPendingPanelLabel").show(),a("#PaymentPendingPanelLabel").html("Your payment of ".concat(t.LastPaymentAmountDisplayValue," is received")));break;case"AutoPay":a("#AutoPayPanel").show(),t.ScheduledAutoBillPaymentDateDisplayValue?a("#AutoPayLabel").text("Auto Pay is scheduled for </br> ".concat(t.ScheduledAutoBillPaymentDateDisplayValue)):a("#AutoPayLabel").text("Auto Pay is scheduled for your next payment date");break;case"PaymentScheduled":a("#PaymentScheduledPanel").show(),a("#PaymentScheduledLabel").text("Your payment of ".concat(t.LastPaymentAmountDisplayValue," is is scheduled for ").concat(t.ScheduledAutoBillPaymentDateDisplayValue));break;case"MakePayment":a("#MakePaymentPanel").show();break;default:a("#MakePaymentPanel").show()}}}}(jQuery),NyServicePlans=function(i){var n,a,s,f,l,P=null,o=!1,r=null;function c(){this.length=8,this.timestamp=+new Date;this.generate=function(){for(var e,t,n=this.timestamp.toString().split("").reverse(),a="",o=0;o<this.length;++o){a+=n[(e=0,t=n.length-1,Math.floor(Math.random()*(t-e+1))+e)]}return a}}function u(e){var t=null===o?0:1e3;P=null,o=!1,r&&clearTimeout(r),f.data.datasets[0].data=[0,0,0,0],f.update();try{p()}catch(e){console.error(e)}r=setTimeout(function(){o=!0,_.isFunction(e)&&e()},t)}function p(){var e=document.getElementById("gaugeText").getContext("2d");return e.clearRect(0,0,1e3,1e3),e.textAlign="center",e}return{Init:function(e){n=e,i('[data-toggle="tooltip"]').tooltip(),i("#myCurrentPlanInfo").popover({html:!0,sanitize:!1,content:function(){var e=i(this).attr("data-popover-content");return i(e).children(".popover-body").html()}}),i(document).on("click",".current-plan-info-close-popover",function(){i("#myCurrentPlanInfo").popover("hide")}),i(document).on("click",'[id ^= "planinfopopover-"]',function(){var e=i(this).attr("id").split("planinfopopover-")[1];i("#".concat(e)).popover("hide")}),i(window).resize(function(){console.log(f.width)})},LoadMyServicePlans:function(o){i("#MyServicePlanLoadingPanel").show(),i("#MyServicePlanPanel").hide(),i("#RenewPlanInfoPanel").hide(),i("#CurrentPlanInfoPanel").hide(),i("#PendingRenewalPlanPanel").hide(),i("#RenewalPlanPanel").hide(),i("#CurrentPlanPanel").hide(),i("#HoldOverPlanPanel").hide(),i("#CurrentPlanDocuments").hide(),i("#RenewalViewCurrentViewPanel").hide(),a=o.SelectedAccount.split("*")[1],SelectedAccountNumber=o.SelectedAccount.split("*")[0].split("-")[0];var r=o.SelectedAccountDetails.ContractType,e=o.SelectedAccount.split("*")[0].split("-")[1],t="".concat(n.getCurrentPlanInfo,"?CustomerAccountId=").concat(e);fetch(t,{method:"GET",headers:{"Content-Type":"application/json",Access_Token:a,Is_Ajax_Request:!0}}).then(function(e){200===e.status?e.json().then(function(e){if(e){i("#RenewPlanInfoPanel").hide(),i("#CurrentPlanInfoPanel").show();var n=e.CurrentPlan,a=e.RenewedPlan,t="CURRENTPLAN";t="RENEWPLAN",t=o.SelectedAccountDetails.Renew?"RENEWPLAN":1==n.ContractTerm?"MTM":"CURRENTPLAN",i("#AccountNumberDisplay").html(SelectedAccountNumber),"CURRENTPLAN"===t?(i("#CurrentPlanPanel").show(),i("#CurrentPlanProductName").html(e.CurrentPlan.ProductTitle),i("#CurrentPlanRate").html(parseFloat(e.CurrentPlan.EFLRate).toFixed(1)),i("#CurrentPlanRateAt").html(e.CurrentPlan.EFLRateAt),i("#CurrentPlanTerm").html(e.CurrentPlan.ContractTerm),i("#CurrentPlanStartDate").html(o.SelectedAccountDetails.ContractStartDate),i("#CurrentPlanEndDate").html(o.SelectedAccountDetails.ContractEndDate),i("#MyCurrentPlanInfoMainBtn").popover({html:!0,container:"body",sanitize:!1,content:function(){var e={Name:"John",PlanName:n.ProductTitle+" (Current plan)",EFLLink:n.EFLLink,TOSLink:n.TOSLink,YRAACLink:n.YRAACLink,EFLRate:n.EFLRate,EFLRateAt:n.EFLRateAt,ContractTerm:n.ContractTerm,MonthlyFee:n.MonthlyFee,ETFCharge:n.ETFCharge?n.ETFCharge:150,PricePlanScript:n.PricePlanScript,Id:"MyCurrentPlanInfoMain",ButtonId:"planinfopopover-MyCurrentPlanInfoMainBtn"},t=i("#planinfopopovertemplate").html();return Mustache.to_html(t,e)}}),i("#CurrentPlanDocuments").show(),i("#CurrentPlanTOSDocument").attr("href",e.CurrentPlan.TOSLink),i("#CurrentPlanEFLDocument").attr("href",e.CurrentPlan.EFLLink),i("#CurrentPlanYRAACDocument").attr("href",e.CurrentPlan.YRAACLink)):"RENEWPLAN"===t?(i("#RenewPlanInfoPanel").show(),i("#CurrentPlanInfoPanel").hide(),i("#RenewPlanAccountNumberDisplay").html(SelectedAccountNumber),i("#RenewPlanContractEndDate").html(o.SelectedAccountDetails.ContractEndDate),i("#CurrentPlanDocuments").hide(),i("#RenewalViewCurrentViewPanel").show(),i("#RenewalPlanPanel").show(),i("#RenewalViewCurrentPlanInfoBtn").popover({html:!0,container:"body",sanitize:!1,content:function(){var e={Name:"John",PlanName:n.ProductTitle+" (Current plan)",EFLLink:n.EFLLink,TOSLink:n.TOSLink,YRAACLink:n.YRAACLink,EFLRate:n.EFLRate,EFLRateAt:n.EFLRateAt,ContractTerm:n.ContractTerm,MonthlyFee:n.MonthlyFee,ETFCharge:n.ETFCharge?n.ETFCharge:150,PricePlanScript:n.PricePlanScript,ButtonId:"planinfopopover-RenewalViewCurrentPlanInfoBtn",Id:"RenewalViewCurrentPlanInfo"},t=i("#planinfopopovertemplate").html();return Mustache.to_html(t,e)}})):"RENEWEDPLAN"===t?(i("#PendingRenewalPlanPanel").show(),i("#PendingRenewalProductName").html(a.ProductTitle),i("#PendingRenewalPlanRate").html(parseFloat(a.EFLRate).toFixed(1)),i("#PendingRenewalPlanTerm").html(a.ContractTermCode),i("#PendingRenewalPlanStartDate").html("02/25/2020"),i("#PendingRenewalPlanEndDate").html("02/25/2021"),i("#CurrentPlanDocuments").hide(),i("#RenewalViewCurrentViewPanel").show(),i("#PendingRenewalPlanInfoBtn").popover({html:!0,container:"body",sanitize:!1,content:function(){var e={Name:"John",PlanName:a.ProductTitle,EFLLink:a.EFLLink,TOSLink:a.TOSLink,YRAACLink:a.YRAACLink,EFLRate:a.EFLRate,EFLRateAt:a.EFLRateAt,ContractTermCode:a.ContractTermCode,MonthlyFee:a.MonthlyFee,ETFCharge:a.ETFCharge,Id:"PendingRenewalPlanInfo",ButtonId:"planinfopopover-PendingRenewalPlanInfoBtn"},t=i("#planinfopopovertemplate").html();return Mustache.to_html(t,e)}}),i("#PendingRenewalPlanCurrentPlanInfoBtn").popover({html:!0,container:"body",sanitize:!1,content:function(){var e={Name:"John",PlanName:n.ProductTitle+" (Current plan)",EFLLink:n.EFLLink,TOSLink:n.TOSLink,YRAACLink:n.YRAACLink,EFLRate:n.EFLRate,EFLRateAt:n.EFLRateAt,ContractTerm:n.ContractTerm,MonthlyFee:n.MonthlyFee,ETFCharge:n.ETFCharge?n.ETFCharge:150,PricePlanScript:n.PricePlanScript,Id:"PendingRenewalPlanCurrentPlanInfo",ButtonId:"planinfopopover-PendingRenewalPlanCurrentPlanInfoBtn"},t=i("#planinfopopovertemplate").html();return Mustache.to_html(t,e)}})):"MTM"===t&&(i("#HoldOverPlanPanel").show(),i("#MonthToMonthPlanProductName").html(n.ProductTitle),i("#MonthToMonthPlanStartDate").html("01/21/2020"),i("#CurrentPlanDocuments").show(),i("#RenewalViewCurrentViewPanel").hide(),i("#HoldOverPlanBtn").popover({html:!0,container:"body",sanitize:!1,content:function(){var e={Name:"John",PlanName:n.ProductTitle,EFLLink:n.EFLLink,TOSLink:n.TOSLink,YRAACLink:n.YRAACLink,EFLRate:n.EFLRate,EFLRateAt:n.EFLRateAt,ContractTerm:n.ContractTerm,MonthlyFee:n.MonthlyFee,ETFCharge:n.ETFCharge?n.ETFCharge:150,PricePlanScript:n.PricePlanScript,Id:"HoldOverPlanInfo",ButtonId:"planinfopopover-HoldOverPlanBtn"},t=i("#planinfopopovertemplate").html();return Mustache.to_html(t,e)}}),i("#CurrentPlanTOSDocument").attr("href",e.CurrentPlan.TOSLink),i("#CurrentPlanEFLDocument").attr("href",e.CurrentPlan.EFLLink),i("#CurrentPlanYRAACDocument").attr("href",e.CurrentPlan.YRAACLink)),s=document.getElementById("myChart"),f=new Chart(s,{type:"pie",data:{datasets:[{data:[0,0,0,0],backgroundColor:["rgba(6,81,128,1.0)","rgba(46,177,52,1.0)","rgba(254,162,32,1.0)","red"],borderWidth:1}]},options:{cutoutPercentage:85,responsive:!0,maintainAspectRatio:!1,legend:{display:!1},tooltips:{callbacks:{label:function(e){return"holdover"===l?"Plan Time Remaining":"renewal"===l?"Plan Time Remaining":[" Plan Time Used"," Plan Time Remaining"," 30 Day Reminder"," 15 Day Reminder"][e.index]}}}}});"MTM"===r?(l="holdover",u(function(){f.data.datasets[0].data=[0,1,0,0],f.update();try{document.getElementById("gaugeText").getContext("2d"),window.devicePixelRatio;var e=p();e.fillStyle="black",e.font="bold 100pt sans-serif",e.fillText("All Set!",500,475),e.font="50pt sans-serif",e.fillStyle="rgba(46,177,52,1.0)",e.fillText("No Expiration Date",500,580),e.fillText("on your plan",500,670)}catch(e){console.error(e)}})):function(h,m){l="standard",u(function(){var e=new Date,n=P=new Date,t=h.getTime(),a=e.getTime(),o=m.getTime();console.log("arguments",h,e,m);var r=Math.round(Math.abs((o-t)/864e5)),i=Math.round(Math.abs((a-t)/864e5)),s=r-i,l=Math.round(100*s/r);if(s<=15)f.data.datasets[0].data=[95,0,0,5],f.update();else if(s<=30)f.data.datasets[0].data=[95,0,5,5],f.update();else{var c=r-30,u=Math.round(90*i/c);f.data.datasets[0].data=[u,90-u,5,5],f.update()}try{var d=p();if(d.font="50pt sans-serif",d.fillStyle="rgba(46,177,52,1.0)",s<=30?(d.fillText("Lock in A",500,610),d.fillText("New Fixed Rate!",500,695)):s<=90?(d.fillText("It’s Time To",500,610),d.fillText("Renew Your Plan!",500,695)):(d.fillText("Your Plan is in",500,610),d.fillText("Good Shape!",500,695)),d.fillStyle="black",s<=30){d.font="bold 40pt sans-serif",d.fillText("Day".concat(1==s?"":"s"," of Your"),500,450),d.fillText("Contract Remaining",500,500),d.font="bold 150pt sans-serif";!function e(t){n===P&&(d.clearRect(0,125,1e3,250),d.fillText("".concat(t),500,325),++t<=s&&setTimeout(function(){return e(t)},75))}(0)}else d.font="bold 150pt sans-serif",d.fillText("".concat(l,"%"),500,350),d.font="bold 40pt sans-serif",d.fillText("of Contract Time",500,450),d.fillText("Remaining",500,500)}catch(e){console.error(e)}})}(new Date("11/15/2019"),new Date("11/15/2020"))}else;}):400===e.status?e.json().then(function(e){}).catch(function(e){throw e}):e.status}).catch(function(e){}).finally(function(){i("#MyServicePlanLoadingPanel").hide(),i("#MyServicePlanPanel").show(),i(".myServiceRenewUpgradePlansList").show()})},SetFeaturedPlan:function(e){var t=new c;if((e=JSON.parse(JSON.stringify(e))).Id=t.generate(),e){var n=i("#featuredPlanCardTemplate").html();i("#FeaturedOfferPanel").empty().html(Mustache.to_html(n,{RootTag:e}))}}}}(jQuery),PaymentAccounts=function(o){var r,i,s,l,t,n,c,u;return{Init:function(e,t,n){function a(e){if(e&&e.data){var t=o("#PaymentAccountsIFrame")[0];if("ViewMyBill"===e.data.Redirect&&(window.location.href="/Payments/ViewMyBill"),e.data.height&&t.contentWindow===e.source&&(t.height=e.data.height+"px",t.style.height=e.data.height+"px"),e.data.Loaded)var n=setInterval(function(e){c&&(clearInterval(n),t.contentWindow.postMessage(c,"*"))},200);if(e.data.INSERTPCI){var a={ChildId:e.data.ChildUniqueId,PCISessionId:e.data.PCISessionId,Url:"".concat(r.validatePCITransactionLog),InsertPCITransactionUrl:"".concat(r.insertPCITransaction),AccessToken:l,SelectedAccountNumber:u};PaymentsHelper.ValidatePCITransaction(a,function(){o("#PaymentAccountsLoadingPanel").hide(),o("#PaymentAccountsPanel").show(),o("#PaymentAccountsErrorPanel").hide()},function(){o("#PaymentAccountsLoadingPanel").hide(),o("#PaymentAccountsPanel").hide(),o("#PaymentAccountsErrorPanel").show()})}}}r=e,i=t,s=n,document.querySelector("#PaymentAccountsIFrame").onload=function(){},o("#PaymentAccountsIFrame").on("load",function(){}),window.addEventListener?window.addEventListener("message",a,!1):window.attachEvent("onmessage",a)},LoadPaymentAccounts:function(e){o("#PaymentAccountsLoadingPanel").show(),o("#PaymentAccountsPanel").hide(),o("#PaymentAccountsErrorPanel").hide(),l=e.SelectedAccount.split("*")[1],n=e.SelectedAccountDetails,u=e.SelectedAccount.split("*")[0].split("-")[0],t="".concat(r.getPaymentToken),fetch(t,{method:"GET",headers:{"Content-Type":"application/json"}}).then(function(e){200===e.status?e.json().then(function(e){if(e){var t=e.SessionId;(c={SessionId:t,CustomerNumber:n.Customer_Number,CustomerAccountId:n.CustomerAccountId,AccountStatus:n.AccountStatus,ConnectStatus:n.ConnectStatus,PastDue:n.PastDue,CurrentBalance:n.CurrentBalance,IsAutoPay:n.Auto_Pay,LastInvoiceDueDate:n.LastInvoiceDueDate,IsInsertPCILog:"1",PastDueDisplayValue:n.PastDueDisplayValue,CurrentBalaceDisplayValue:n.CurrentBalaceDisplayValue,FirstName:o("#FirstNameHidden").val(),LastName:o("#LastNameHidden").val(),Email:n.Email,ContactNumber:n.Cell}).ContactNumber||n.Phone,document.getElementById("PaymentAccountsIFrame").src="".concat(s,"/PaymentAccounts?Brand=").concat(i)}}):400===e.status?e.json().then(function(e){}).catch(function(e){throw e}):e.status}).catch(function(e){}).finally(function(){})}}}(jQuery),PaymentsHelper=function(o){function r(e){var t="".concat(e.Url);fetch(t,{method:"POST",headers:{RequestVerificationToken:o('input:hidden[name="__RequestVerificationToken"]').val(),"Content-Type":"application/json",Access_Token:e.AccessToken},body:JSON.stringify(e)}).then(function(e){200===e.status?e.json().then(function(e){}):400===e.status?e.json().then(function(e){}).catch(function(e){throw e}):e.status}).catch(function(e){}).finally(function(){})}return{ValidatePCITransaction:function(t,n,a){fetch(t.Url,{method:"POST",headers:{RequestVerificationToken:o('input:hidden[name="__RequestVerificationToken"]').val(),"Content-Type":"application/json",Access_Token:t.AccessToken},body:JSON.stringify(t)}).then(function(e){200===e.status?e.json().then(function(e){1==e.ResultCode?n():a&&(r({message:"Try Again CustNo: "+t.SelectedAccountNumber,SourcePage:"Source Page: MyAccount - Payments,",Url:"".concat(t.InsertPCITransactionUrl),AccessToken:t.AccessToken}),a())}):400===e.status?e.json().then(function(e){}).catch(function(e){throw e}):e.status}).catch(function(e){}).finally(function(){})},InsertPCILog:r,InsertTransaction:function(e){var t="".concat(e.Url);fetch(t,{method:"POST",headers:{RequestVerificationToken:o('input:hidden[name="__RequestVerificationToken"]').val(),"Content-Type":"application/json",Access_Token:e.AccessToken},body:JSON.stringify(e)}).then(function(e){200===e.status?e.json().then(function(e){}):400===e.status?e.json().then(function(e){}).catch(function(e){throw e}):e.status}).catch(function(e){}).finally(function(){})}}}(jQuery),PaymentHistory_Invoices=function(h){var a;return{Init:function(e){a=e},LoadInvoices:function(e){h("#btnInvoices").removeClass().addClass("btn btn-primary"),h("#btnPayments").removeClass().addClass("btn btn-outline-secondary");var n=e.SelectedAccount.split("*")[1],t="".concat(a.getInvoices),d="".concat(a.downloadInvoice);fetch(t,{method:"GET",headers:{"Content-Type":"application/json",Access_Token:n,Is_Ajax_Request:!0}}).then(function(e){200===e.status?e.json().then(function(a){if(h("#InvoicesPanelLoadingScreen").hide(),a){h("#InvoicesPanel").show();var o=[{title:"Invoice Date",name:"InvoiceDate",sort:"desc",type:"date"},{title:"Due Date",name:"InvoiceDueDate",sort:"",type:"date"},{title:"Total",name:"TotalAmount",sort:"",type:"dollar"},{title:"Paid Date",name:"InvoicePaidDate",sort:"",type:"date"}],r={paging:!0,sorting:{columnHeaders:o}},i=[],s=1,l=10,e=a.length,t=Math.ceil(e/l);h(document).on("click",'[id ^= "InvoiceColumn-"]',function(){var t=h(this).attr("id").split("InvoiceColumn-")[1];!function(n){var e=Object.assign({},r.sorting).columnHeaders.map(function(e){if(n.name!==e.name)return Object.assign(e,{sort:""});var t="asc"===e.sort?"desc":"asc";return Object.assign(e,{sort:t})}),t=Object.assign({},r,{sorting:{columns:e}});s=1,c(),u(t)}(o.find(function(e){return e.name===t}))}),h(document).on("click",'[id ^= "ViewInvoiceDetailsBtn-"]',function(){h(this).attr("id").split("ViewInvoiceDetailsBtn-")[1];h("#ViewInvoiceDetailsModal-placeholder").find(".modal").modal({backdrop:"static",keyboard:!1,show:!0})}),h(document).on("click",'[id ^= "DownloadInvoiceBtn-"]',function(){var e=h(this).attr("id").split("DownloadInvoiceBtn-")[1],t=d+"?accessToken="+n+"&invoiceNumber="+e;return window.open(t,"__blank").focus(),!1}),h(document).on("click",'[id ^= "PrintInvoiceBtn-"]',function(){var e=h(this).attr("id").split("PrintInvoiceBtn-")[1];!function(e){var t=h("iframe#iframeprint");t.attr("src",e),t.on("load",function(){var e=document.getElementById("iframeprint");e.focus(),e.contentWindow.print()})}(d+"?accessToken="+n+"&invoiceNumber="+e)}),h("#btnModalClose").click(function(){return h("#ViewInvoiceDetailsModal").modal("hide")}),u(r),c()}else h("#NoInvoicesPanel").show();function c(){h("#invoicesPagination").empty(),h("#invoicesPagination").bootpag({page:s,total:t,maxVisible:5,leaps:!0,next:"Next >>",prev:"<< Prev"}).on("page",function(e,t){s=t,u(r)})}function u(e){e.sorting&&Object.assign(r.sorting,e.sorting);var t=function(e,t){if(!t.sorting)return e;var n=(r.sorting.columnHeaders||[]).find(function(e){if(e.hasOwnProperty("sort")&&""!==e.sort)return!0});return e.sort(function(e,t){if("date"===n.type){if(new Date(null!=e[n.name]?e[n.name]:new Date)>new Date(null!=t[n.name]?t[n.name]:new Date))return"desc"===n.sort?-1:1;if(new Date(null!=e[n.name]?e[n.name]:new Date)<new Date(null!=t[n.name]?t[n.name]:new Date))return"asc"===n.sort?-1:1}else if("dollar"===n.type){if(e[n.name]>t[n.name])return"desc"===n.sort?-1:1;if(e[n.name]<t[n.name])return"asc"===n.sort?-1:1}return 0})}(a,r);i=function(e,t,n){return--n,e.slice(n*t,(n+1)*t)}(t,l,s),function(){var e=h("#invoicesHeader").find("th").length;3<e&&h("#invoicesHeader").find("th").slice(0,e-3).remove();var t=h("#invoicesHeaderTemplate").html();h("#invoicesHeader").prepend(Mustache.to_html(t,{RootTag:o}))}();var n=h("#invoicesTemplate").html();h("#invoicestblBody").empty().html(Mustache.to_html(n,{RootTag:i}))}}):400===e.status?e.json().then(function(e){}).catch(function(e){throw e}):e.status}).catch(function(e){}).finally(function(){})}}}(jQuery),PaymentHistory_Payments=function(d){var a;return{Init:function(e){a=e},LoadPayments:function(e){d("#btnPayments").removeClass().addClass("btn btn-primary"),d("#btnInvoices").removeClass().addClass("btn btn-outline-secondary");var t=e.SelectedAccount.split("*")[1],n="".concat(a.getPayments);fetch(n,{method:"GET",headers:{"Content-Type":"application/json",Access_Token:t,Is_Ajax_Request:!0}}).then(function(e){200===e.status?e.json().then(function(a){if(d("#PaymentsPanelLoadingScreen").hide(),a){d("#PaymentsPanel").show();var o=[{title:"Payment Date",name:"Date",sort:"desc",type:"date"},{title:"Total",name:"Amount",sort:"",type:"dollar"},{title:"Type",name:"Type",sort:"",type:"dollar"},{title:"Auto Pay",name:"IsAutoPay",sort:"",type:"dollar"}],r={paging:!0,sorting:{columnHeaders:o}},i=[],s=1,l=10,e=a.length,t=Math.ceil(e/l);d(document).on("click",'[id ^= "PaymentColumn-"]',function(){var t=d(this).attr("id").split("PaymentColumn-")[1];!function(n){var e=Object.assign({},r.sorting).columnHeaders.map(function(e){if(n.name!==e.name)return Object.assign(e,{sort:""});var t="asc"===e.sort?"desc":"asc";return Object.assign(e,{sort:t})}),t=Object.assign({},r,{sorting:{columns:e}});s=1,c(),u(t)}(o.find(function(e){return e.name===t}))}),u(r),c()}else d("#NoPaymentsPanel").show();function c(){d("#paymentsPagination").empty(),d("#paymentsPagination").bootpag({page:s,total:t,maxVisible:5,leaps:!0,next:"Next >>",prev:"<< Prev"}).on("page",function(e,t){s=t,u(r)})}function u(e){e.sorting&&Object.assign(r.sorting,e.sorting);var t=function(e,t){if(!t.sorting)return e;var n=(r.sorting.columnHeaders||[]).find(function(e){if(e.hasOwnProperty("sort")&&""!==e.sort)return!0});return e.sort(function(e,t){if("date"===n.type){if(new Date(null!=e[n.name]?e[n.name]:new Date)>new Date(null!=t[n.name]?t[n.name]:new Date))return"desc"===n.sort?-1:1;if(new Date(null!=e[n.name]?e[n.name]:new Date)<new Date(null!=t[n.name]?t[n.name]:new Date))return"asc"===n.sort?-1:1}else if("dollar"===n.type){if(e[n.name]>t[n.name])return"desc"===n.sort?-1:1;if(e[n.name]<t[n.name])return"asc"===n.sort?-1:1}return 0})}(a,r);i=function(e,t,n){return--n,e.slice(n*t,(n+1)*t)}(t,l,s),function(){var e=d("#paymentsHeaderTemplate").html();d("#paymentsHeader").empty().html(Mustache.to_html(e,{RootTag:o}))}();var n=d("#paymentsTemplate").html();d("#paymentstblBody").empty().html(Mustache.to_html(n,{RootTag:i}))}}):400===e.status?e.json().then(function(e){}).catch(function(e){throw e}):e.status}).catch(function(e){}).finally(function(){})}}}(jQuery),PaymentOptions_AutoPay=function(o){var r,i,s,t,n,l,c,u;return{Init:function(e,t,n){function a(e){if(e&&e.data){var t=o("#PaymentOptionsAutoPayIFrame")[0];if(e.data.height&&t.contentWindow===e.source&&(t.height=e.data.height+"px",t.style.height=e.data.height+"px"),e.data.Loaded)var n=setInterval(function(e){l&&(clearInterval(n),t.contentWindow.postMessage(l,"*"))},200);if(e.data.INSERTPCI){var a={ChildId:e.data.ChildUniqueId,PCISessionId:e.data.PCISessionId,Url:"".concat(r.validatePCITransactionLog),InsertPCITransactionUrl:"".concat(r.insertPCITransaction),AccessToken:s,SelectedAccountNumber:u};PaymentsHelper.ValidatePCITransaction(a,function(){o("#PaymentOptionsAutoPayErrorPanel").hide(),o("#PaymentOptionsAutoPayLoadingPanel").hide(),o("#PaymentOptionsAutoPayPanel").show()},function(){o("#PaymentOptionsAutoPayLoadingPanel").hide(),o("#PaymentOptionsAutoPayPanel").hide(),o("#PaymentOptionsAutoPayErrorPanel").show()})}}}r=e,c=t,i=n,document.querySelector("#PaymentOptionsAutoPayIFrame").onload=function(){},o("#PaymentOptionsAutoPayIFrame").on("load",function(){}),window.addEventListener?window.addEventListener("message",a,!1):window.attachEvent("onmessage",a)},LoadAutoPay:function(e){o("#AutoPayBtn").addClass("payment-option-active"),o("#BudgetBillingBtn").removeClass("payment-option-active"),o("#PaymentExtensionBtn").removeClass("payment-option-active"),o("#PaymentOptionsAutoPayLoadingPanel").show(),o("#PaymentOptionsAutoPayPanel").hide(),o("#PaymentOptionsAutoPayErrorPanel").hide(),s=e.SelectedAccount.split("*")[1],n=e.SelectedAccountDetails,u=e.SelectedAccount.split("*")[0].split("-")[0],t="".concat(r.getPaymentToken),fetch(t,{method:"GET",headers:{"Content-Type":"application/json"}}).then(function(e){200===e.status?e.json().then(function(e){if(e){var t=e.SessionId;(l={SessionId:t,CustomerNumber:n.Customer_Number,CustomerAccountId:n.CustomerAccountId,AccountStatus:n.AccountStatus,ConnectStatus:n.ConnectStatus,PastDue:n.PastDue,CurrentBalance:n.CurrentBalance,IsAutoPay:n.Auto_Pay,LastInvoiceDueDate:n.LastInvoiceDueDate,IsInsertPCILog:"1",PastDueDisplayValue:n.PastDueDisplayValue,CurrentBalaceDisplayValue:n.CurrentBalaceDisplayValue,FirstName:o("#FirstNameHidden").val(),LastName:o("#LastNameHidden").val(),Email:n.Email,ContactNumber:n.Cell}).ContactNumber||n.Phone,document.getElementById("PaymentOptionsAutoPayIFrame").src="".concat(i,"autobillpay?Brand=").concat(c)}}):400===e.status?e.json().then(function(e){}).catch(function(e){throw e}):e.status}).catch(function(e){}).finally(function(){})}}}(jQuery),PaymentOptions_BudgetBilling=function(t){return{Init:function(e,t){t,e},LoadBudgetBilling:function(e){t("#AutoPayBtn").removeClass("payment-option-active"),t("#BudgetBillingBtn").addClass("payment-option-active"),t("#PaymentExtensionBtn").removeClass("payment-option-active"),e.SelectedAccount.split("*")[1]}}}(jQuery),PaymentOptions_PaymentExtension=function(t){return{Init:function(e,t){e,t=t},LoadPaymentExtension:function(e){t("#AutoPayBtn").removeClass("payment-option-active"),t("#BudgetBillingBtn").removeClass("payment-option-active"),t("#PaymentExtensionBtn").addClass("payment-option-active"),e.SelectedAccount.split("*")[1]}}}(jQuery),WeeklyUsage_EnergyInSights=function(o){var r;function i(e,t){var n=new google.visualization.DataTable;n.addColumn("string","UsageType"),n.addColumn("string","Date"),n.addColumn("number","Usage (kwh)"),n.addColumn("number","Usage ($)"),n.addColumn("number","Avg Temperature");var a=function(e){var t=[];if(null!=e&&""!=e)for(var n=e.split(";"),a=0;a<n.length;a++){var o=n[a].split(",");t.push([o[0],o[1],parseInt(o[2]),parseFloat(o[3]),parseFloat(o[4])])}return t}(e);n.addRows(a);var o=new google.visualization.DataView(n);o.setColumns([1,{calc:s,type:"number"},{calc:l,type:"number"},{calc:c,role:"certainty",type:"boolean"},{calc:d,role:"scope",type:"boolean"},4,{calc:u,role:"certainty",type:"boolean"}]);(e=new google.visualization.ComboChart(document.getElementById("chart1_div"))).draw(o,{title:"Daily Usage",hAxis:{title:"Dates"},height:330,width:820,vAxes:{0:{title:"Daily Usage (KWH)",textStyle:{color:"black"},titleTextStyle:{color:"black"}},1:{title:"Avg Temperature F",textStyle:{color:"red"},titleTextStyle:{color:"red"}}},seriesType:"bars",series:{0:{type:"bars",targetAxisIndex:0,labelInLegend:"Last Invoice",color:"#EA7516"},1:{type:"bars",targetAxisIndex:0,labelInLegend:"Next Invoice",color:"#F19713"},2:{type:"line",targetAxisIndex:1,pointShape:"circle",color:"#ff5151"}},pointSize:7});var r=new google.visualization.DataTable;r.addColumn("string","DOW"),r.addColumn("number","PrevUsage"),r.addColumn("number","PrevTemp"),r.addColumn("number","CurrentUsage"),r.addColumn("number","CurrentTemp");var i=function(e){var t=[];if(null!=e&&""!=e)for(var n=e.split(";"),a=0;a<n.length;a++){var o=n[a].split(",");t.push([o[0],parseInt(o[1]),parseFloat(o[2]),parseInt(o[3]),parseFloat(o[4])])}return t}(t);r.addRows(i);(t=new google.visualization.ComboChart(document.getElementById("chart2_div"))).draw(r,{chart:{title:"Weekly Usage Summary"},legend:{textStyle:{fontSize:12}},seriesType:"bars",hAxis:{title:"Day of week"},height:200,width:820,vAxes:{0:{title:"Daily Usage (KWH)",textStyle:{color:"black"},titleTextStyle:{color:"black"}},1:{title:"Avg Temperature F",textStyle:{color:"black"},titleTextStyle:{color:"black"}}},series:{0:{type:"bars",targetAxisIndex:0,labelInLegend:"Last Week Usage",color:"#EA7516"},1:{type:"line",targetAxisIndex:1,pointShape:"circle",color:"#EA7516",labelInLegend:"Last Week Temp"},2:{type:"bars",targetAxisIndex:0,labelInLegend:"Current Week Usage",color:"#F19713"},3:{type:"line",targetAxisIndex:1,pointShape:"circle",color:"#F19713",labelInLegend:"Current Week Temp"}},pointSize:7})}function s(e,t){var n=null;return"L"==e.getValue(t,0).trim().charAt(0)&&(n=e.getValue(t,2)),n}function l(e,t){var n=null;return"N"==e.getValue(t,0).trim().charAt(0)&&(n=e.getValue(t,2)),n}function c(e,t){var n=!1;return"A"==e.getValue(t,0).trim().charAt(1)&&(n=!0),n}function u(e,t){var n=!1;return"A"==e.getValue(t,0).trim().charAt(1)&&(n=!0),n}function d(e,t){var n=!0;return"N"==e.getValue(t,0).charAt(1)&&(n=!1),n}return{Init:function(e){r=e},LoadWeeklyUsageDetails:function(e){o("#UsageTrackerDataPanel").hide(),o("#UsageTrackerLoadingPanel").show(),o("#NoUsageTrackerDataPanel").hide();var t=e.SelectedAccount.split("*")[1],n=e.SelectedAccount.split("-")[1].split("*")[0],a="".concat(r.getWeeklyUsageDetails,"?CustomerAccountId=").concat(n);fetch(a,{method:"GET",headers:{"Content-Type":"application/json",Access_Token:t,Is_Ajax_Request:!0}}).then(function(e){200===e.status?e.json().then(function(e){o("#UsageTrackerLoadingPanel").hide(),o("#UsageTrackerDataPanel").show(),o("#lblThisWeekKWH").text(e.ThisWeekKWH),o("#lblThisWeekAmt").text(e.ThisWeekAmt),o("#lblWeeklyAmountDiff").text(e.WeeklyAmtDiff),o("#lblLastWeekAmt").text(e.LastWeekAmt),o("#lblLastWeekFrom").text(e.LastWeekFrom),o("#lblLastWeekTo").text(e.LastWeekTo),o("#lblThisWeekFrom").text(e.ThisWeekFrom),o("#lblThisWeekTo").text(e.ThisWeekTo),o("#lblLastWeekKWH").text(e.LastWeekKWH),o("#lblThisWeekKWH1").text(e.ThisWeekKWH),o("#lblWeeklyKWHDiff").text(e.WeeklyKWHDiff),o("#lblLastWeekAmt1").text(e.LastWeekAmt),o("#lblThisWeekAmt1").text(e.ThisWeekAmt),o("#lblWeeklyAmtDiff").text(e.WeeklyAmtDiff),o("#lblLastWeekDailyKWH").text(e.LastWeekDailyKWH),o("#lblThisWeekDailyKWH").text(e.ThisWeekDailyKWH),o("#lblWeeklyDailyUsageDiff").text(e.WeeklyDailyUsageDiff),o("#lblCustName").text(e.CustName),e.ThisWeekAmt<e.LastWeekAmt?o("#lblLessorGtr").text("less"):e.ThisWeekAmt>e.LastWeekAmt?o("#lblLessorGtr").text("greater"):o("#lblLessorGtr").text("equal"),o("#lblLastInvoiceFrom").text(e.LastInvoiceFrom),o("#lblLastInvoiceTo").text(e.LastInvoiceTo),o("#lblLastInvoiceAmt").text(e.LastInvoiceAmt),o("#lblNextInvoiceFrom").text(e.NextInvoiceFrom),o("#lblNextInvoiceTo").text(e.NextInvoiceTo),o("#lblProjectedInvoiceAmt").text(e.ProjectedInvoiceAmt),o("#lblServiceAddress").text(e.ServiceAddress),o("#circlelblThisWeekKWH").text(e.ThisWeekKWH),o("#circlelblThisWeekAmt").text(e.ThisWeekAmt),o("#circlelblWeeklyAmountDiff").text(e.WeeklyAmtDiff),o("#circlelblLastWeekAmt").text(e.LastWeekAmt),o("#circlelblLastWeekFrom").text(e.LastWeekFrom),o("#circlelblLastWeekTo").text(e.LastWeekTo),o("#circlelblThisWeekFrom").text(e.ThisWeekFrom),o("#circlelblThisWeekTo").text(e.ThisWeekTo),o("#circlelblLastWeekKWH").text(e.LastWeekKWH),o("#circlelblThisWeekKWH1").text(e.ThisWeekKWH),o("#circlelblWeeklyKWHDiff").text(e.WeeklyKWHDiff),o("#circlelblLastWeekAmt1").text(e.LastWeekAmt),o("#circlelblThisWeekAmt1").text(e.ThisWeekAmt),o("#circlelblWeeklyAmtDiff").text(e.WeeklyAmtDiff),o("#circlelblLastWeekDailyKWH").text(e.LastWeekDailyKWH),o("#circlelblThisWeekDailyKWH").text(e.ThisWeekDailyKWH),o("#circlelblWeeklyDailyUsageDiff").text(e.WeeklyDailyUsageDiff),o("#circlelblCustName").text(e.CustName),e.ThisWeekAmt<e.LastWeekAmt?o("#circlelblLessorGtr").text("less"):e.ThisWeekAmt>e.LastWeekAmt?o("#circlelblLessorGtr").text("greater"):o("#circlelblLessorGtr").text("equal"),o("#circlelblLastInvoiceFrom").text(e.LastInvoiceFrom),o("#circlelblLastInvoiceTo").text(e.LastInvoiceTo),o("#circlelblLastInvoiceAmt").text(e.LastInvoiceAmt),o("#circlelblNextInvoiceFrom").text(e.NextInvoiceFrom),o("#circlelblNextInvoiceTo").text(e.NextInvoiceTo),o("#circlelblProjectedInvoiceAmt").text(e.ProjectedInvoiceAmt),o("#circlelblServiceAddress").text(e.ServiceAddress),i(e.Chart1,e.Chart2)}):400===e.status?e.json().then(function(e){}).catch(function(e){throw e}):500===e.status&&(o("#UsageTrackerDataPanel").hide(),o("#UsageTrackerLoadingPanel").hide(),o("#NoUsageTrackerDataPanel").show())}).catch(function(e){}).finally(function(){})}}}(jQuery),ReferAFriend_ReferralOptions=function(i){var s,n,l;function o(){this.length=8,this.timestamp=+new Date;this.generate=function(){for(var e,t,n=this.timestamp.toString().split("").reverse(),a="",o=0;o<this.length;++o){a+=n[(e=0,t=n.length-1,Math.floor(Math.random()*(t-e+1))+e)]}return a}}function c(e,t){var n=i("#".concat(e));if(n&&0<n.length){var a=n.validate().checkForm();if(Array.isArray(t)){for(var o=0;o<t.length;o++)t[o]="#".concat(t[o]);t=t.join()}else t="#".concat(t);a?i(t).removeClass("disabled"):i(t).addClass("disabled")}}function r(e){i("#".concat(e," input[type='email']")).valid()}return{Init:function(e,t){s=e,n=t,i("#SelectReferralLinkBtn").click(function(){var e=document.getElementById("ReferralLinkText");e.focus(),e.select()}),i("#addNewFriendBtn").click(function(){if(4!==i('[id^="AddNewReferAFriendPanel-"]').length){var e=i("#referAFriendTemplate").html(),t={},n=(new o).generate();t.Id=n;var a=Mustache.to_html(e,t);i("#ReferFriendsList").append(a),i(document).on("click",'[id^="RemoveReferAFriendBtn-'.concat(n,'"]'),function(){var e=i(this).attr("id").split("RemoveReferAFriendBtn-")[1];i("#AddNewReferAFriendPanel-".concat(e)).remove(),r("ReferFriendsList"),c("ReferAFriendForm","ReferFriendsSubmitBtn")}),i(".referAFriendEmail").each(function(){i(this).rules("add",{required:!0,email:!0})}),r("ReferFriendsList"),c("ReferAFriendForm","ReferFriendsSubmitBtn")}}),i("form[id='ReferAFriendForm']").validate({rules:{InitialReferAFriendEmail:{required:!0,email:!0}},messages:{InitialReferAFriendEmail:{required:"Email is required.",email:"Email is invalid."}},highlight:function(e){i(e).addClass("is-invalid")},unhighlight:function(e){i(e).removeClass("is-invalid")},errorPlacement:function(e,t){i(t).next().append(e)},submitHandler:function(e,t){t.preventDefault();var n=i("#FullNameHidden").val(),a="";i(".referAFriendEmail").each(function(){a=a+i(this).val()+";"});var o={To:a,Type:"ReferAFriend",Subject:"Switch and Lower Your Energy Bill in 5 Minutes!",CustomerName:n};console.log(a);var r="".concat(s.referAFriend);fetch(r,{method:"POST",headers:{RequestVerificationToken:i('input:hidden[name="__RequestVerificationToken"]').val(),"Content-Type":"application/json",Access_Token:l,Is_Ajax_Request:!0},body:JSON.stringify(o)}).then(function(e){200===e.status?e.json().then(function(e){1===e.ResultCode&&(i("#ReferralEmailSuccessPanel").show(),i("#ReferFriendsList :text").val(""),i("#ReferFriendsList input[type='email']").val(""),c("ReferAFriendForm","ReferFriendsSubmitBtn"))}).catch(function(e){throw e}):404===e.status?e.json().then(function(e){}):e.status}).catch(function(e){}).finally(function(){})}}),i("#ReferAFriendForm").on("blur keyup change","input",function(e){c("ReferAFriendForm","ReferFriendsSubmitBtn")}),c("ReferAFriendForm","ReferFriendsSubmitBtn")},LoadReferralOptions:function(e){i("#btnReferralOptions").removeClass().addClass("btn btn-myAccountPrimary"),i("#btnMyRewards").removeClass().addClass("btn btn-outline-secondary"),i("#btnRewardPreferences").removeClass().addClass("btn btn-outline-secondary"),l=e.SelectedAccount.split("*")[1],i("#AccountNumberDisplay").html();var t=n.replace("CustomerNumber",e.SelectedAccount.split("*")[0].split("-")[0]);i("#ReferralLinkText").val(t)}}}(jQuery),ReferAFriend_MyRewards=function(t){return{Init:function(e){e},LoadMyRewards:function(e){t("#btnReferralOptions").removeClass().addClass("btn btn-outline-secondary"),t("#btnMyRewards").removeClass().addClass("btn btn-myAccountPrimary"),t("#btnRewardPreferences").removeClass().addClass("btn btn-outline-secondary")}}}(jQuery),ReferAFriend_RewardPreferences=function(t){return{Init:function(e){e},LoadRewardPreferences:function(e){t("#btnReferralOptions").removeClass().addClass("btn btn-outline-secondary"),t("#btnMyRewards").removeClass().addClass("btn btn-outline-secondary"),t("#btnRewardPreferences").removeClass().addClass("btn btn-myAccountPrimary")}}}(jQuery),Registration=function(a){var t;return{Init:function(e){"frontier"===(t=e).toLowerCase()?a("#BrandTitle").html("for Frontier"):"gexa"===t.toLowerCase()&&a("#BrandTitle").html("for Gexa"),a("#btnModalClose").click(function(){return a("#registrationModal").modal("hide")}),a("#btnUserLogin").click(function(){return a("#registrationModal").modal("hide")}),function(){var n={};a("form[id='userRegistrationForm']").validate({rules:{UserPassword:{minlength:4,maxlength:8},ConfirmPassword:{minlength:4,maxlength:8,equalTo:'[name="UserPassword"]'}},messages:{UserPassword:{minlength:"Password should be a minimum of 4 characters"},ConfirmPassword:{minlength:"Password should be a minimum of 4 characters",equalTo:"Passwords should match"}},highlight:function(e){a(e).addClass("is-invalid")},unhighlight:function(e){a(e).removeClass("is-invalid")},errorPlacement:function(e,t){a(t).next().append(e)},submitHandler:function(e){a("#userRegistrationError").hide();var t={Email:n.Email,AccountNumber:n.AccountNumber,Password:a("input[name='UserPassword']").val(),AccessToken:n.AccessToken,State:n.State};a("#userRegistrationBtnProcessing").show(),a("#userRegistrationBtn").hide(),fetch("Account/RegisterUser",{method:"POST",headers:{RequestVerificationToken:a('input:hidden[name="__RequestVerificationToken"]').val(),"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(e){200===e.status?e.json().then(function(e){a("#btnRegisterToolbar").hide(),a("#userRegistrationSuccess").show(),a("#btnUserLogin").show()}).catch(function(e){throw e}):404===e.status?e.json().then(function(e){a("#userRegistrationError").show(),a("#userRegistrationError").find("b").html(e.Message)}):500===e.status&&(a("#userRegistrationError").show(),a("#userRegistrationError").find("b").html("Could not complete user registration!! Please try again!!"))}).catch(function(e){a("#userRegistrationError").show(),a("#userRegistrationError").find("b").html("Could not complete user registration!! Please try again!!")}).finally(function(){a("#userRegistrationBtn").show(),a("#userRegistrationBtnProcessing").hide()})}}),a("form[id='validateRegistrationForm']").validate({rules:{Email:{email:!0,required:!0},AccountNumber:{required:!0,minlength:4,maxlength:8},PhoneNumber:{required:!0,minlength:10,maxlength:10,number:!0},Last4SSN:{number:!0,minlength:4,maxlength:4},StreetNumber:{minlength:4,maxlength:20}},messages:{Email:{email:"Please enter a valid Email",required:"Please enter your Email"},AccountNumber:{required:"Please enter you Account Number",minlength:"Account Number should be at least 3 characters"},PhoneNumber:{required:"Please enter your Phone Number.",minlength:"Phone Number should be 10 digits",number:"Phone Number should be 10 digits"},Last4SSN:{minlength:"Should be 4 digits",number:"Last 4 of SSN should be a number"},StreetNumber:{minlength:"Street Number should be atleast 4 characters"}},highlight:function(e){a(e).addClass("is-invalid")},unhighlight:function(e){a(e).removeClass("is-invalid")},errorPlacement:function(e,t){a(t).next().append(e)},submitHandler:function(e){a("#verifyUserRegistrationError").hide();var t={EmailAddress:a("input[name='Email']").val(),AccountNumber:a("input[name='AccountNumber']").val(),PhoneNumber:a("input[name='PhoneNumber']").val()};t.Last4SSN=a("input[name='Last4SSN']").val()||null,t.StreetNumber=a("input[name='StreetNumber']").val()||null,a("#verifyUserRegistrationBtnProcessing").show(),a("#verifyUserRegistrationBtn").hide(),fetch("Account/VerifyUserRegistration",{method:"POST",headers:{RequestVerificationToken:a('input:hidden[name="__RequestVerificationToken"]').val(),"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(e){200===e.status?e.json().then(function(e){n.Email=e.Email,n.AccountNumber=e.AccountNumber,n.AccessToken=e.AccessToken,n.Name=e.Name,n.State=e.State,a("#userNameLabel").find("b").html(n.Name),a("#verfiyUserRegistrationPanel").hide(),a("#registrationPanel").show()}):404===e.status?e.json().then(function(e){a("#verifyUserRegistrationError").show(),a("#verifyUserRegistrationError").find("b").html(e.Message)}).catch(function(e){throw e}):500===e.status&&(a("#verifyUserRegistrationError").show(),a("#verifyUserRegistrationError").find("b").html("Error in verifying the user registration!! Please try again!!"))}).catch(function(e){a("#verifyUserRegistrationError").show(),a("#verifyUserRegistrationError").find("b").html("Error in verifying the user registration!! Please try again!!")}).finally(function(){a("#verifyUserRegistrationBtnProcessing").hide(),a("#verifyUserRegistrationBtn").show()})}})}()}}}(jQuery),RenewalPlans=function(r){var i,s,l,t,c;return{Init:function(e){i=e,r("#ViewMorePlansSelectPanel").find("i").click(function(){r(this).toggleClass("fa-chevron-up fa-chevron-down"),r("#RenewMorePlansPanel").toggle("slow",function(){})}),r("#btnPlanConfirmationModalClose").click(function(){r("#planconfirmationModal").modal("hide")}),r("#btnErrorModalClose").click(function(){r("#errorModal").modal("hide")}),r("#errorModal,#planconfirmationModal").on("hidden.bs.modal",function(e){r("#ParentRenewalPanel *").prop("disabled",!1),r('[id ^= "btnSubmitRenewal-"]').show(),r('[id ^= "btnSubmitRenewalProcessing-"]').hide()})},LoadRenewalPlans:function(e){l=e.SelectedAccount.split("*")[1],t="".concat(i.getRenewalPlans,"?Customer_Account_Id=").concat(e.SelectedAccountDetails.CustomerAccountId),c=e.SelectedAccountDetails,e.SelectedAccountDetails.ReNew?(r("#RenewalPlansPanel").hide(),r("#RenewalPlansLoadingPanel").show(),fetch(t,{method:"GET",headers:{"Content-Type":"application/json",Access_Token:l,Is_Ajax_Request:!0}}).then(function(e){200===e.status?e.json().then(function(e){if(r("#RenewalPlansLoadingPanel").hide(),e&&0!==e.length){r("#RenewalPlansPanel").show(),r("#Top3RenewPlansPanel").show(),r("#NoRenewalPlansPanel").hide(),console.log(e[0]),e.forEach(function(e){e.ContractTermCode=e.ContractTermCode.split("MTH")[0]}),s=e,NyServicePlans.SetFeaturedPlan(e[0]);var t=s.slice(0,3),n=r("#renewPlanCardTemplate").html();if(r("#Top3RenewPlansPanel").empty().html(Mustache.to_html(n,{RootTag:t})),3<e.length){r("#ViewMorePlansSelectPanel").show();var a=s.slice(3,s.length),o=r("#renewPlanCardTemplate").html();r("#RenewMorePlansPanel").empty().html(Mustache.to_html(o,{RootTag:a}))}r(document).off("click",'[id ^= "WhatsInPlanFlip-"]').on("click",'[id ^= "WhatsInPlanFlip-"]',function(){var e=r(this).attr("id").split("WhatsInPlanFlip-")[1];r("#plan_".concat(e)).toggleClass("applyflip")}),r(document).off("click",'[id ^= "RevertPlanFlip-"]').on("click",'[id ^= "RevertPlanFlip-"]',function(){var e=r(this).attr("id").split("RevertPlanFlip-")[1];r("#plan_".concat(e)).toggleClass("applyflip")}),r(document).off("click",'[id ^= "SelectPlanFlip-"]').on("click",'[id ^= "SelectPlanFlip-"]',function(){var e=r(this).attr("id").split("SelectPlanFlip-")[1];r("#plan_".concat(e)).toggleClass("applyflip"),r("#planSelect_confirm_"+e).toggleClass("reveal")}),r(document).off("click",'[id ^= "SelectPlan-"]').on("click",'[id ^= "SelectPlan-"]',function(){var e=r(this).attr("id").split("SelectPlan-")[1];r("#planSelect_confirm_"+e).toggleClass("reveal")}),r(document).off("click",'[id ^= "OfferAgreedCheck-"]').on("click",'[id ^= "OfferAgreedCheck-"]',function(){var e=r(this).attr("id").split("OfferAgreedCheck-")[1];r(this).prop("checked")?r("#btnSubmitRenewal-".concat(e)).prop("disabled",!1):r("#btnSubmitRenewal-".concat(e)).prop("disabled",!0)}),r(document).off("click",'[id ^= "btnSubmitRenewal-"]').on("click",'[id ^= "btnSubmitRenewal-"]',function(){var t=r(this).attr("id").split("btnSubmitRenewal-")[1];r(this).hide(),r("#btnSubmitRenewalProcessing-".concat(t)).show();var e=s.find(function(e){return e.Id===t}),n={CustomerAccountId:c.CustomerAccountId,PricePlanCode:e.PricePlanCode,TcoCode:e.TCOCode,RenewRate:e.UnitRate,ProductCode:e.ProductCode,ContractTermCode:e.ContractTermCode,ProductTitle:e.ProductTitle,CustomerName:c.CustomerName,Email:c.Email,PostalAddress:{Line_1:c.PostalAddress1,City:c.PostalAddressCity,State:c.PostalAddressState,Zip:c.PostalPostCode},EflRate:e.EFLRate,EtfCharge:e.ETFCharge,TdspCode:e.TDSPCode,CustomerNumber:c.Customer_Number,Phone:c.Phone};fetch(i.renew,{method:"POST",headers:{RequestVerificationToken:r('input:hidden[name="__RequestVerificationToken"]').val(),"Content-Type":"application/json",Access_Token:l},body:JSON.stringify(n)}).then(function(e){200===e.status?e.json().then(function(e){1===e.ResultCode?(r("#PlanConfirmationModal-placeholder").find(".modal").modal({backdrop:"static",keyboard:!1,show:!0}),AccountSelector.Reload()):r("#ErrorModal-placeholder").find(".modal").modal({backdrop:"static",keyboard:!1,show:!0})}):400===e.status?e.json().then(function(e){}).catch(function(e){throw e}):e.status}).catch(function(e){}).finally(function(){}),r("#ParentRenewalPanel *").prop("disabled",!0)}),r(document).off("click",'[id ^= "btnCancelRenewal-"]').on("click",'[id ^= "btnCancelRenewal-"]',function(){var e=r(this).attr("id").split("btnCancelRenewal-")[1];r("#planSelect_confirm_".concat(e)).toggleClass("reveal")})}else r("#NoRenewalPlansPanel").show()}):400===e.status?e.json().then(function(e){}).catch(function(e){throw e}):e.status}).catch(function(e){}).finally(function(){})):(r("#RenewalPlansPanel").show(),r("#RenewalPlansLoadingPanel").hide(),r("#NoRenewalPlansPanel").show())}}}(jQuery),ResetPassword=function(r){var i;return{Init:function(e){r("#btnModalClose").click(function(){return r("#registrationModal").modal("hide")}),r("#btnUserLogin").click(function(){return r("#registrationModal").modal("hide")}),r("#btnSMSCancel").click(function(){window.location.reload()}),r("#btnVerifySMSCancel").click(function(){return window.location.reload()}),function(){var n={},a={},o={};r("form[id='forgotPasswordForm']").validate({rules:{Email:{email:!0,required:!0}},messages:{Email:{email:"Please enter a valid Email",required:"Please enter your Email"}},highlight:function(e){r(e).addClass("is-invalid")},unhighlight:function(e){r(e).removeClass("is-invalid")},errorPlacement:function(e,t){r(t).next().append(e)},submitHandler:function(e){r("#forgotPasswordError").hide();var t={Email:r("input[name='Email']").val()};t.ValidationType=r("input[name=optradio]:checked").val(),r("#forgotPasswordBtnProcessing").show(),r("#forgotPasswordBtn").hide(),fetch("ForgotPassword",{method:"POST",headers:{RequestVerificationToken:r('input:hidden[name="__RequestVerificationToken"]').val(),"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(e){200===e.status?e.json().then(function(e){n.AccountNumber=e.AccountNumber,n.AccessToken=e.AccessToken,n.MaskedMobileNumber=e.MaskedMobileNumber,"email"===t.ValidationType.toLowerCase()?(r("#forgotpasswordInputPanel").hide(),r("#forgotPasswordSuccessPanel").show()):"sms"===t.ValidationType.toLowerCase()&&(r("#forgotpasswordInputPanel").hide(),r("#forgotPasswordSuccessPanel").hide(),r("#forgotPasswordSendSMSPanel").show(),r("#smsMobileNumberLabel").text(e.MaskedMobileNumber))}):404===e.status?e.json().then(function(e){r("#forgotPasswordError").show(),r("#forgotPasswordError").find("b").html(e.Message)}).catch(function(e){throw e}):500===e.status&&(r("#forgotPasswordError").show(),r("#forgotPasswordError").find("b").html("Error in verifying the email for resetting password!! Please try again!!"))}).catch(function(e){r("#forgotPasswordError").show(),r("#forgotPasswordError").find("b").html("Error in verifying the email for resetting the password!! Please try again!!")}).finally(function(){r("#forgotPasswordBtnProcessing").hide(),r("#forgotPasswordBtn").show()})}}),r("form[id='forgotPasswordSendSMSForm']").validate({rules:{"sendSMSCheck[]":{required:!0,minlength:1}},messages:{"sendSMSCheck[]":"Please select the checkbox to get the SMS."},highlight:function(e){r(e).addClass("is-invalid")},unhighlight:function(e){r(e).removeClass("is-invalid")},errorPlacement:function(e,t){r(t).next().append(e)},submitHandler:function(e){r("#sendSMSError").hide();var t={AccessToken:n.AccessToken};r("#sendSMSBtnProcessing").show(),r("#sendSMSBtn").hide(),fetch("SendSMS",{method:"POST",headers:{RequestVerificationToken:r('input:hidden[name="__RequestVerificationToken"]').val(),"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(e){200===e.status?e.json().then(function(e){a.AccountNumber=e.AccountNumber,a.AccessToken=e.AccessToken,a.MaskedMobileNumber=e.MaskedMobileNumber,r("#forgotPasswordVerifySMSPanel").show(),r("#forgotPasswordSendSMSPanel").hide()}):400===e.status?e.json().then(function(e){r("#sendSMSError").show(),r("#sendSMSError").find("b").html(e.Message)}).catch(function(e){throw e}):500===e.status&&(r("#sendSMSError").show(),r("#sendSMSError").find("b").html("Error in sending the SMS!! Please try again!!"))}).catch(function(e){r("#sendSMSError").show(),r("#sendSMSError").find("b").html("Error in sending the SMS!! Please try again!!")}).finally(function(){r("#sendSMSBtnProcessing").hide(),r("#sendSMSBtn").show()})}}),r("form[id='forgotPasswordVerifySMSForm']").validate({rules:{SMSText:{minlength:3,maxlength:5,required:!0}},messages:{SMSText:{minlength:"SMS code should be atleast 3 characters.",required:"Please enter your SMS code."}},highlight:function(e){r(e).addClass("is-invalid")},unhighlight:function(e){r(e).removeClass("is-invalid")},errorPlacement:function(e,t){r(t).next().append(e)},submitHandler:function(e){r("#forgotPasswordVerifySMSError").hide();var t={AccessToken:a.AccessToken,SMSCode:r("input[name='SMSText']").val()};r("#verifySMSBtnProcessing").show(),r("#verifySMSBtn").hide(),fetch("VerifySMSCode",{method:"POST",headers:{RequestVerificationToken:r('input:hidden[name="__RequestVerificationToken"]').val(),"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(e){200===e.status?e.json().then(function(e){r("#forgotPasswordVerifySMSPanel").hide(),r("#resetPasswordPanel").show(),o.AccountNumber=e.AccountNumber,o.AccessToken=e.AccessToken,o.MaskedMobileNumber=e.MaskedMobileNumber}):400===e.status?e.json().then(function(e){r("#forgotPasswordVerifySMSError").show(),r("#forgotPasswordVerifySMSError").find("b").html(e.Message)}).catch(function(e){throw e}):500===e.status&&(r("#forgotPasswordVerifySMSError").show(),r("#forgotPasswordVerifySMSError").find("b").html("Error in verifying the SMS Code!! Please try again!!"))}).catch(function(e){r("#forgotPasswordVerifySMSError").show(),r("#forgotPasswordVerifySMSError").find("b").html("Error in verifying the SMS Code!! Please try again!!")}).finally(function(){r("#verifySMSBtnProcessing").hide(),r("#verifySMSBtn").show()})}}),r("form[id='resetPasswordForm']").validate({rules:{UserPassword:{minlength:4,maxlength:8},ConfirmPassword:{minlength:4,maxlength:8,equalTo:'[name="UserPassword"]'}},messages:{UserPassword:{minlength:"Password should be a minimum of 4 characters"},ConfirmPassword:{minlength:"Password should be a minimum of 4 characters",equalTo:"Passwords should match"}},highlight:function(e){r(e).addClass("is-invalid")},unhighlight:function(e){r(e).removeClass("is-invalid")},errorPlacement:function(e,t){r(t).next().append(e)},submitHandler:function(e){var t;i?t=i:o&&o.AccessToken&&(t=o.AccessToken),r("#resetPasswordError").hide();var n={AccessToken:t,NewPassword:r("input[name='UserPassword']").val()};r("#resetPasswordBtnProcessing").show(),r("#resetPasswordBtn").hide(),fetch("ResetPassword",{method:"POST",headers:{RequestVerificationToken:r('input:hidden[name="__RequestVerificationToken"]').val(),"Content-Type":"application/json"},body:JSON.stringify(n)}).then(function(e){200===e.status?e.json().then(function(e){r("#resetPasswordSuccessPanel").show(),r("#btnResetPasswordToolbar").hide()}):400===e.status?e.json().then(function(e){r("#resetPasswordError").show(),r("#resetPasswordError").find("b").html(e.Message)}).catch(function(e){throw e}):500===e.status&&(r("#resetPasswordError").show(),r("#resetPasswordError").find("b").html("Error in resetting the Password!! Please try again!!"))}).catch(function(e){r("#resetPasswordError").show(),r("#resetPasswordError").find("b").html("Error in resetting the Password!! Please try again!!")}).finally(function(){r("#resetPasswordBtnProcessing").hide(),r("#resetPasswordBtn").show()})}})}(),(i=e)?(r("#forgotpasswordInputPanel").hide(),r("#resetPasswordPanel").show()):(r("#forgotpasswordInputPanel").show(),r("#resetPasswordPanel").hide())}}}(jQuery),UsageSummary=function(i){var a;return{Init:function(e){a=e},LoadUsageSummary:function(n){i("#UsageSummaryLoading").show(),i("#UsageSummaryPanel").hide(),setTimeout(function(){try{var e=n.SelectedAccount.split("*")[1],t=a.getUsageHistory;fetch(t,{method:"GET",headers:{"Content-Type":"application/json",Access_Token:e,Is_Ajax_Request:!0}}).then(function(e){200===e.status?e.json().then(function(e){if(e){var t=function(e){var t={};for(var n in e)e[n]&&(t[e[n].EndDate]||(t[e[n].EndDate]={usage:0,date:moment(new Date(e[n].EndDate).toISOString(),moment.ISO_8601).toDate()}),t[e[n].EndDate].usage+=parseInt(e[n].KWH));return _.sortBy(_.values(t))}(e);t.sort(function(e,t){return e.date-t.date});var n=["January","February","March","April","May","June","July","August","September","October","November","December"],a=_.takeRight(t,3);[].push({datasets:[{data:_.map(a,function(e){return e.usage}),backgroundColor:["rgb(27,141,205)"],borderColor:["rgb(27,141,205)"],borderWidth:10,label:"Energy Consumption"}],labels:_.map(a,function(e){return n[e.date.getMonth()]})});var o={datasets:[{data:_.map(a,function(e){return e.usage}),backgroundColor:"rgb(27,141,205)",borderColor:"rgb(27,141,205)",borderWidth:10,label:"Energy Consumption"}],labels:_.map(a,function(e){return n[e.date.getMonth()]})},r=i("#UsageSummaryCanvas")[0].getContext("2d");new Chart(r,{type:"bar",data:o,options:{scaleShowVerticalLines:!1,responsive:!0,maintainAspectRatio:!1,legend:{position:"top"},tooltips:{callbacks:{label:function(e){return e.yLabel+"kwh"}}},scales:{yAxes:[{id:"y-axis-1",type:"linear",position:"left",ticks:{min:0,stepSize:100}}]}}})}}):400===e.status?e.json().then(function(e){}).catch(function(e){throw e}):401===e.status?UnAuthorizedHandler.Handle401():e.status}).catch(function(e){}).finally(function(){i("#UsageSummaryLoading").hide(),i("#UsageSummaryPanel").show()})}catch(e){}},0)}}}(jQuery),ViewMyBill=function(n){var a;return{Init:function(e){e},LoadViewMyBill:function(e){e.SelectedAccount.split("*")[1],a=e.SelectedAccountDetails,n("#viewMyBillLoadingPanel").hide(),n("#viewMyBillPanel").show(),n("#AccountNumberDisplay").html(e.SelectedAccount.split("*")[0].split("-")[0]);var t=parseFloat(a.TotalDue);if((a.IsPastDue||a.TotalDue&&0<t)&&a.HasAtleastOnePayment&&(n("#DueDate").show(),n("#DueDate").text("Due Date: ".concat(a.LatestInvoiceDueDate)),n("#DueDateResponsive").show(),n("#DueDateResponsive").text("Due Date: ".concat(a.LatestInvoiceDueDate))),!a.IsPastDue&&a.HasAtleastOnePayment&&t<=0&&(n("#LatestPaymentPanel").show(),n("#LatestBillAmount").text(a.LastPaymentAmountDisplayValue),n("#LatestBillPaymentDate").text(a.LastPaymentDateDisplayValue),n("#LatestPaymentPanelResponsive").show(),n("#LatestBillAmountResponsive").text(a.LastPaymentAmountDisplayValue),n("#LatestBillPaymentDateResponsive").text(a.LastPaymentDateDisplayValue)),n("#TotalDueLabel").text(a.TotalDueDisplayValue),n("#CurrentDueLabel").text(a.CurrentBalaceDisplayValue),n("#PastDueLabel").text(a.PastDueDisplayValue),a.MyBillDisplayView)switch(a.MyBillDisplayView){case"PastDuePayNow":n("#PastDuePayNowPanel").show();break;case"AutoPay":n("#AutoPayPanel").show(),a.ScheduledAutoBillPaymentDateDisplayValue?n("#AutoPayLabel").text("Auto Pay is scheduled for </br> ".concat(selectedAccount.ScheduledAutoBillPaymentDateDisplayValue)):n("#AutoPayLabel").text("Auto Pay is scheduled for your next payment date");break;case"MakePayment":n("#MakePaymentPanel").show();break;default:n("#MakePaymentPanel").show()}}}}(jQuery);